(window.multistep_editor_jsonpFunction=window.multistep_editor_jsonpFunction||[]).push([[41],{918:function(t,e){t.exports='<style>\n    :host {\n        width: 100%;\n        height: 100%;\n    }\n</style>\n\n<iframe id="frameID" width="100%" height="100%" style="border: none;"></iframe>\n\n'},948:function(t,e,n){"use strict";n.r(e),n.d(e,"AuWidgetTemplateEditor",function(){return a}),n.d(e,"widget",function(){return a});var i=n(0),r=n(172),o=n(1),s=n(918),c=n(6),a=function(t){function e(){var e=t.call(this)||this;return e._eventsInited=!1,e.script="",e.styles="",e._iframeLoaded=!1,e._initIFrame=e._initIFrame.bind(e),e._loadResources(),e}return Object(i.d)(e,t),e.prototype._loadResources=function(){return Object(i.b)(this,void 0,void 0,function(){var t,e,n,r,o,s;return Object(i.e)(this,function(a){switch(a.label){case 0:return t=Date.now(),e=c.a.getPatchedUrl("static/template-editor/script.html")+"?t="+t,n=c.a.getPatchedUrl("static/template-editor/style.html")+"?t="+t,[4,Promise.all([c.a.loadHtml(e),c.a.loadHtml(n)])];case 1:return r=i.h.apply(void 0,[a.sent(),2]),o=r[0],s=r[1],this.script=o.replace("TextWhizzJS.wasm",""+c.a.getPatchedUrl("static/data-driven-editor/TextWhizzJS.wasm")),this.styles=s,[4,this._initIFrame()];case 2:return a.sent(),[2]}})})},e.prototype.updateParams=function(t,e){},e.prototype.updateParamsAsync=function(e,n){return Object(i.b)(this,void 0,void 0,function(){var r;return Object(i.e)(this,function(i){switch(i.label){case 0:return t.prototype.updateParamsAsync.call(this,e,n),[4,this._itemPromise()];case 1:return r=i.sent(),[4,this._initSubscribers(this._element)];case 2:return i.sent(),r.configuration=Object.assign({language:this.language},e.config),e.stateId?[4,this.setStateId(e.stateId)]:[3,4];case 3:return i.sent(),[3,7];case 4:return e.product?[4,this.setProduct(e.product)]:[3,6];case 5:return i.sent(),[3,7];case 6:console.warn("stateId or product missing."),i.label=7;case 7:return[2]}})})},e.prototype.getProduct=function(){return Object(i.b)(this,void 0,void 0,function(){return Object(i.e)(this,function(t){return[2,this._element.getProductJson()]})})},e.prototype.setProduct=function(t){return Object(i.b)(this,void 0,void 0,function(){return Object(i.e)(this,function(e){return this._element.setProductJson(t),[2]})})},e.prototype.setStateId=function(t){return Object(i.b)(this,void 0,void 0,function(){return Object(i.e)(this,function(e){switch(e.label){case 0:return[4,this._element.setStateId(t)];case 1:return e.sent(),[2]}})})},e.prototype.setToken=function(t){return Object(i.b)(this,void 0,void 0,function(){return Object(i.e)(this,function(e){return this._element.setToken(t),[2]})})},e.prototype.saveProduct=function(){return Object(i.b)(this,void 0,void 0,function(){return Object(i.e)(this,function(t){switch(t.label){case 0:return[4,this._element.saveProduct()];case 1:return t.sent(),[2]}})})},e.prototype._iframeLoadedPromise=function(){var t=this;return new Promise(function(e,n){!0===t._iframeLoaded?e():t._iframeDoc.addEventListener("DOMContentLoaded",function(){t._iframeLoaded=!0,e()})})},e.prototype._itemPromise=function(){var t=this;return new Promise(function(e,n){if(t._element)e(t._element);else{var r=function(){setTimeout(function(){return Object(i.b)(t,void 0,void 0,function(){var t;return Object(i.e)(this,function(n){return this._iframeDoc&&(t=this._iframeDoc.querySelector("au-template-editor"))&&(this._element=t,window.Aurigma=Object.assign(window.Aurigma,this._iframeWin.contentWindow.Aurigma),e(t)),this._element||r(),[2]})})},200)};r()}})},e.prototype._itemInitedPromise=function(){var t=this;return new Promise(function(e,n){return Object(i.b)(t,void 0,void 0,function(){var t;return Object(i.e)(this,function(n){switch(n.label){case 0:return[4,this._itemPromise()];case 1:return(t=n.sent()).isInited&&e(t),t.addEventListener("inited",function(n){e(t)}),[2]}})})})},e.prototype._initSubscribers=function(t){return Object(i.b)(this,void 0,void 0,function(){return Object(i.e)(this,function(e){switch(e.label){case 0:return this._eventsInited?[3,2]:(this._eventsInited=!0,this.$productSaved=t.$productSaved(),[4,this._getLocales(t)]);case 1:e.sent(),e.label=2;case 2:return[2]}})})},e.prototype._getLocales=function(t){return Object(i.b)(this,void 0,void 0,function(){var e,n,r,o,s,a;return Object(i.e)(this,function(u){switch(u.label){case 0:return[4,c.a.loadJson("static/template-editor/locales.json?t="+Date.now())];case 1:e=u.sent();try{for(n=Object(i.k)(Object.keys(e)),r=n.next();!r.done;r=n.next())o=r.value,t.addLocalization(o,e[o])}catch(t){s={error:t}}finally{try{r&&!r.done&&(a=n.return)&&a.call(n)}finally{if(s)throw s.error}}return t.setLanguage(this.language),[2]}})})},e.prototype._initIFrame=function(){return Object(i.b)(this,void 0,void 0,function(){var t,e,n;return Object(i.e)(this,function(i){return t=this.querySelectorShadow("#frameID"),e=t||t.contentWindow,(n=t.contentDocument||e.document).write('<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500&display=swap" rel="stylesheet" />'),n.write('<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />'),n.write(this.script),n.write(this.styles),n.write("<style> .mat-button-toggle-button { height: 100%; } </style>"),n.write('<div style="width:100%;height:100%"><au-template-editor id="templateeditor"></au-template-editor> </div>'),this._iframeDoc=n,this._iframeWin=e,[2]})})},e=Object(i.c)([Object(o.a)("au-widget-template-editor",s),Object(i.g)("design:paramtypes",[])],e)}(r.c)}}]);