(window.multistep_editor_jsonpFunction=window.multistep_editor_jsonpFunction||[]).push([[24],{427:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(){function e(){}return e.throw=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];throw e+": "+t.join(", ")},e.InvalidProcessorExpression="Invalid expression",e.CannotFoundType="Cannot found type",e.CannotFoundTypeConstructor="Cannot found constructor of type",e.CannotFoundStaticMethod="Cannot found static method",e.CannotFoundEnum="Cannot found enumeration",e.InvalidEnumValue="Enum does not contain value",e.DublicateTypesFound="Dublicate types have been detected",e.CommandNotFound="Command not found",e}()},511:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(176),i=n(453),s=function(){function e(){}return Object.defineProperty(e,"iframeApiPromise",{get:function(){return this._iframeApiSubject.pipe(Object(i.a)(1)).toPromise()},enumerable:!1,configurable:!0}),e.loadCCScript=function(e,t){var n=this;if("undefined"!=typeof CustomersCanvas||document.body.querySelector("#CcIframeApiScript"))"undefined"!=typeof CustomersCanvas&&this._iframeApiSubject.next(CustomersCanvas);else{this._iframeApiSubject=new r.a(1);var i=document.createElement("script");i.type="text/javascript",i.id="CcIframeApiScript",i.onload=function(e){CustomersCanvas&&n._iframeApiSubject.next(CustomersCanvas)},i.onerror=function(e){n._iframeApiSubject.error(e)},i.src=e+t,document.body.appendChild(i)}return this.iframeApiPromise},e._iframeApiSubject=new r.a(1),e}()},512:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(0),i=n(513),s=n(31),o=n(753),a=n(6),c=n(593),u=n(68),l=function(){function e(e,t,n){void 0===n&&(n=function(){return Promise.resolve()}),this._lastJobKey="init",this._lastExecutedJobSubject=new i.BehaviorSubject("init"),this._commands=e,this._onJobFinish=n,this.logger=new u.Category("command-executer_"+t)}return e.prototype.executeActions=function(e,t,n){var i=this,o=function(a){return Object(r.b)(i,void 0,void 0,function(){var i,c,u,l,d,h,f;return Object(r.e)(this,function(r){switch(r.label){case 0:if(this.logger.debug(function(){return"Execute '"+a+"'"}),i=Promise.resolve(),!(c=this._commands[a])||void 0===c.execute)return[3,5];if(i=c.execute(e[a],n[a]),!(u=e[a].after)&&Array.isArray(e[a])&&(l=e[a].find(function(e){return e.after}))&&(u=l.after),void 0===u)return[3,4];Object(s.a)(u)||(u=[u]),d=function(e,t,n){var r=n.indexOf(e);return n.indexOf(t)>r},h=0,r.label=1;case 1:return h<u.length?(f=u[h],d(a,f,t)?[3,3]:[4,i]):[3,4];case 2:r.sent(),i=o(f),r.label=3;case 3:return h++,[3,1];case 4:return[3,6];case 5:console.warn("Action "+a+" is not supported! Double check the config."),r.label=6;case 6:return[2,i]}})})},c=this.getJobReady(this._lastJobKey),u=this._lastJobKey=a.a.guid();return c.then(function(){return i.logger.debug(function(){return"Start actons: "+t}),a.a.recursiveJobPromise(t,o)}).then(function(){return i._onJobFinish()}).finally(function(){i.logger.debug(function(){return"End actons: "+t}),i._lastExecutedJobSubject.next(u)})},e.prototype.getJobReady=function(e){return this._lastExecutedJobSubject.pipe(Object(c.filter)(function(t){return t===e}),Object(c.take)(1)).toPromise()},e.prototype.getChangedActions=function(e,t){var n=Object.keys(e).filter(function(t){return a.a.isObjectNotEmpty(e[t])}).filter(function(n){return void 0===t[n]||(r=e[n],i=t[n],!(JSON.stringify(r)===JSON.stringify(i)));var r,i}),r=n.indexOf("actionsErrorToast");return-1!==r&&n.splice(r,1),n.indexOf("initial")>-1?["initial"].concat(Object(o.a)(n,"initial")):n},e}()},584:function(e,t,n){"use strict";n.d(t,"a",function(){return g});var r=n(0),i=n(21),s=n(20),o=n(427),a=n(103),c=n(405),u=n(382),l=n(387),d=n(383),h=n(394),f=n(384),p=function(){function e(){this._types=new Map;for(var e=[c,u,l,d],t=0;t<e.length;t++)this._loadModuleTypes(e[t]);this._loadModuleTypes({Collection:h.a})}return e.prototype.fromConstructor=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];Object(f.l)(e)&&o.a.throw("Invalid argument",e);var i=this._findFunction(e);this._isConstructor(i)||o.a.throw(o.a.CannotFoundTypeConstructor,e);var s=i;try{return new(s.bind.apply(s,Object(r.i)([void 0],t)))}catch(e){throw console.error(e),e}},e.prototype._findFunction=function(e){var t=e.split(".");this._types.has(t[0])||o.a.throw(o.a.CannotFoundType,e);for(var n=this._types.get(t[0]),r=1;r<t.length;r++)void 0==n[t[r]]&&o.a.throw(o.a.CannotFoundTypeConstructor,e),n=n[t[r]];return n},e.prototype._isConstructor=function(e){return e instanceof Function&&null!=e.prototype.constructor},e.prototype.fromStaticMethod=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=this._findFunction(e);null!=i&&i instanceof Function||o.a.throw(o.a.CannotFoundStaticMethod,e);try{return i.apply(void 0,Object(r.i)(t))}catch(e){throw console.error(e),e}},e.prototype.fromProperties=function(e,t){var n=this.fromConstructor(e);return Object(f.e)(n,[t],{deep:!1,ignoreNull:!1})},e.prototype.fromEnum=function(e,t){this._types.has(e)||o.a.throw(o.a.CannotFoundEnum,e);var n=this._types.get(e);return n instanceof Object||o.a.throw(o.a.CannotFoundEnum,e),null==n[t]&&o.a.throw(o.a.InvalidEnumValue,{type:e,value:t}),n[t]},e.prototype._loadModuleTypes=function(e){var t,n;if(void 0!==e)try{for(var i=Object(r.k)(Object.entries(e)),s=i.next();!s.done;s=i.next()){var a=Object(r.h)(s.value,2),c=a[0],u=a[1];(u instanceof Function||u instanceof Object)&&(this._types.has(c)&&o.a.throw(o.a.DublicateTypesFound,c),this._types.set(c,u))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},e}(),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.d)(t,e),t.prototype.subProcessorAllocatorFactory=function(){var e=new a.a;return e.register(new m(this,new p)),e},t}(s.a),m=function(e){function t(t,n){var r=e.call(this,t)||this;return r._builder=n,r}return Object(r.d)(t,e),t.prototype.apply=function(e,t,n){var i,s;switch(void 0===n&&(n=function(e){return e}),!0){case Array.isArray(e):return e.map(function(e){return n(e)});case this.isObject(e):var o={};try{for(var a=Object(r.k)(Object.entries(e)),c=a.next();!c.done;c=a.next()){var u=Object(r.h)(c.value,2),l=u[0],d=u[1];if(this._isNewExpression(l)||this._isCallExpression(l))return this._buildObjectModel(l,d,n);o[l]=this._buildModelProperty(d,n)}}catch(e){i={error:e}}finally{try{c&&!c.done&&(s=a.return)&&s.call(a)}finally{if(i)throw i.error}}return o;case this._isEnumExpression(e):return this._parseEnum(e);default:return e}},t.prototype._buildModelProperty=function(e,t){switch(!0){case this.isObject(e):return t(e);case this._isEnumExpression(e):return this._parseEnum(e);default:return e}},t.prototype._parseArguments=function(e,t){var n=this;switch(!0){case Array.isArray(e):return e.map(function(e){return n._parseArguments(e,t)});case this.isObject(e)&&this.canApply(e):return t(e);case this._isEnumExpression(e):return this._parseEnum(e);default:return e}},t.prototype._parseEnum=function(e){var t=this.splitOperandAndCondition(e);1===t.length&&null!=t[0].body||o.a.throw(o.a.InvalidProcessorExpression,e);var n=t[0].body.split(".");return 2==n.length?this._builder.fromEnum(n[0],n[1]):null},t.prototype._buildObjectModel=function(e,t,n){var r=this.splitOperandAndCondition(e);1==r.length&&null!=r[0].body||o.a.throw(o.a.InvalidProcessorExpression,e);var i=r[0].body;return this._isCallExpression(e)?this._buildObjectByFactory(i,t,n):this._createObjectModel(i,t,n)},t.prototype._buildObjectByFactory=function(e,t,n){var r=this,i=t;return Array.isArray(t)?i=t.map(function(e){return r._parseArguments(e,n)}):this.isObject(t)&&(i=n(t)),this._builder.fromStaticMethod(e,i)},t.prototype._createObjectModel=function(e,t,n){var i,s=this;switch(!0){case this.isObject(t):return this._builder.fromProperties(e,n(t));case Array.isArray(t):var o=t.map(function(e){return s._parseArguments(e,n)});return(i=this._builder).fromConstructor.apply(i,Object(r.i)([e],o));default:return this._builder.fromConstructor(e,t)}},t.prototype.canApply=function(e){var t=this;return this.isObject(e)&&void 0!==Object.entries(e).find(function(e){var n=Object(r.h)(e,2),i=n[0],s=n[1];return t._isNewExpression(i)||t._isCallExpression(i)||t._isEnumExpression(s)})},t.prototype._isNewExpression=function(e){return/{{.*(#new).*/gi.test(e)},t.prototype._isCallExpression=function(e){return/{{.*(#call).*/gi.test(e)},t.prototype._isEnumExpression=function(e){return this.isString(e)&&/{{.*(#enum).*/gi.test(e)},t}(i.a)},909:function(e,t){e.exports="<style>\n    :host {\n        width: 100%;\n        height: 100%;\n        display: block;\n        position: initial;\n    }\n\n    #design-editor {\n        position: absolute;\n        height: 1px;\n        min-height: 100%;\n        width: 1px;\n        min-width: 100%;\n        top: 0;\n        bottom: 0;\n        left: 0;\n        right: 0;\n        border: none;\n        background-color: transparent;\n    }\n</style>\n<iframe id='design-editor' allowfullscreen></iframe>\n"},959:function(e,t,n){"use strict";n.r(t),n.d(t,"AuWidgetDesignEditor",function(){return ee}),n.d(t,"widget",function(){return ee});var r=n(0),i=n(909),s=n(172),o=n(178),a=n(453),c=(function(){}(),function(){return function(e){Object.assign(this,e)}}()),u=(function(){}(),function(){}(),n(408)),l=n(547),d=n(548),h=n(549),f=n(550),p=n(489),g=n(448),m=n(435),b=n(411),v=n(508),y=n(6),w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._customersCanvasSubject=new o.ReplaySubject(1),t}return Object(r.d)(t,e),t.prototype.customersCanvasPublish=function(e){this._customersCanvasSubject.next(e)},Object.defineProperty(t.prototype,"customersCanvasObservable",{get:function(){return this._customersCanvasSubject.asObservable()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"customersCanvasPromise",{get:function(){return this.customersCanvasObservable.pipe(Object(a.a)(1)).toPromise()},enumerable:!1,configurable:!0}),t.prototype.getProduct=function(){return Object(r.b)(this,void 0,void 0,function(){return Object(r.e)(this,function(e){switch(e.label){case 0:return[4,this.getEditor()];case 1:return[4,e.sent().getProduct()];case 2:return[2,e.sent()]}})})},t.prototype.getEditor=function(){return Object(r.b)(this,void 0,void 0,function(){return Object(r.e)(this,function(e){switch(e.label){case 0:return[4,this._customersCanvasSubject.asObservable().pipe(Object(a.a)(1)).toPromise()];case 1:return[2,e.sent()]}})})},t.prototype.getDesignEditorItemModel=function(e){return Object(r.b)(this,void 0,void 0,function(){var t,n,i,s,o,a,w,O,P,j,I,C,_,x,S,A,M;return Object(r.e)(this,function(r){switch(r.label){case 0:if(t=e.type===p.b.type,n=e.type===u.a.type||e.type===d.a.type||e.type===h.a.type||e.type===f.a.type||e.type===l.a.type,e.type===g.a.type,i=!1,s=!1,!e)return[2];switch(o={name:e.name},t&&(e=e,i=y.a.isNotNullOrUndefined(e.content)&&(e.content instanceof CustomersCanvas.DesignAtoms.ObjectModel.ImageItem||"ImageItem"===e.content.type),s=y.a.isNotNullOrUndefined(e.content)&&(e.content instanceof CustomersCanvas.DesignAtoms.ObjectModel.BarcodeItem||"BarcodeItem"===e.content.type)),n&&(e=e),!0){case t&&i&&!s&&null!==e.content.tags.sourceData&&void 0!==e.content.tags.sourceData:return[3,1];case t&&i:return[3,7];case n&&!!e.text:return[3,8]}return[3,9];case 1:return a=(e=e).content,w=new b.a(e),O=w.getTransformedRectangle(),P=new m.a(a),j=P.getTransformedRectangle(),[4,this.getEditor()];case 2:I=r.sent(),C=300,r.label=3;case 3:return r.trys.push([3,5,,6]),[4,I.eval("var printArea = spEditor.productHandler.product.surfaces.elementAt(0).printAreas.elementAt(0);var config = spEditor.configuration.renderingConfig.getHiResRendering(printArea);config.dpi;")];case 4:return C=r.sent(),[3,6];case 5:return r.sent(),console.warn("Failed to get hires render config dpi"),[3,6];case 6:return o.tags=Object(v.a)(a.tags),o.value=a.tags.sourceData.name,o.placeholderContent={originalUrl:a.tags.sourceData.originalUrl,width:a.source.width,height:a.source.height,placeholderRectangle:O,contentRectangle:j,contentResizeMode:p.c[e.contentResizeMode].toLowerCase(),contentTransform:{angle:a.transform.angle,scaleX:a.transform.scaleX,scaleY:a.transform.scaleY,translateX:a.transform.translateX,translateY:a.transform.translateY},dpi:C},[3,9];case 7:return o={name:e.name,tags:Object(v.a)(e.tags)},[3,9];case 8:return x="",S=function(e){return(e/255).toFixed(7)},(_=e).color&&("RgbColor"===_.color.type?(A=_.color,x="rgb("+A.r+","+A.g+","+A.b+","+S(A.a)+")"):"CmykColor"===_.color.type&&(M=_.color,x="cmyk("+S(M.c)+","+S(M.m)+","+S(M.y)+","+S(M.k)+","+S(M.a)+")")),o={name:e.name,value:_.text,color:x,font:{postScriptName:_.font.postScriptName,size:_.font.size,fauxBold:_.font.fauxBold,fauxItalic:_.font.fauxItalic}},[3,9];case 9:return t&&((e=e).contentPermissions&&e.contentPermissions.imagePermissions&&(o.contentPermissions={imagePermissions:{allowChangeImage:e.contentPermissions.imagePermissions.allowChangeImage,allowEditImage:e.contentPermissions.imagePermissions.allowEditImage}}),e.placeholderPermissions&&(o.placeholderPermissions={allowEditContent:e.placeholderPermissions.allowEditContent,showHandleButton:e.placeholderPermissions.showHandleButton,showSelectButton:e.placeholderPermissions.showSelectButton})),e.visualizationPermissions&&(o.visualizationPermissions={noPrint:e.visualizationPermissions.noPrint,noShow:e.visualizationPermissions.noShow}),null!==e.locked&&(o.locked=e.locked),[2,new c(o)]}})})},t}(s.c),O=function(){return function(e){this.widget=e}}(),P=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Object(r.d)(t,e),t.prototype.execute=function(e,t){return Object(r.b)(this,void 0,void 0,function(){return Object(r.e)(this,function(e){throw"Not Implemented"})})}}(O),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.d)(t,e),t.prototype.execute=function(e){return Object(r.b)(this,void 0,void 0,function(){var t,n;return Object(r.e)(this,function(r){switch(r.label){case 0:return[4,this.widget.getProduct()];case 1:return t=r.sent(),n=e.data.map(function(e,n){return{mockup:e.mockup,previewMockups:e.previewMockups,surface:t.surfaces[n]}}),[4,t.setMockups(n,e.options)];case 2:return[2,r.sent()]}})})},t}(O)),j=n(44),I=n(933),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.d)(t,e),t.prototype.execute=function(e){return Object(r.b)(this,void 0,void 0,function(){var t=this;return Object(r.e)(this,function(n){switch(n.label){case 0:return[4,this.widget.iframeApiPromise];case 1:return n.sent(),"string"==typeof e.productDefinition&&(e.editorConfig.autoLoadUserInfo=!1,e.editorConfig.userInfo=null,this.widget._stateId=e.productDefinition,this.widget._userId=this.widget.driver.user.id),e.editorConfig=e.editorConfig||{},e.editorConfig.themeConfiguration=e.editorConfig.themeConfiguration||{},this.widget.driver.themeSettings?(e.editorConfig.themeConfiguration.primaryColor=this.widget.driver.themeSettings.primaryColor,e.editorConfig.themeConfiguration.logo=this.widget.driver.themeSettings.logo):e.editorConfig.themeConfiguration.primaryColor=getComputedStyle(document.documentElement).getPropertyValue("--theme-primary-color"),[4,this.load(e.productDefinition,e.editorConfig,e.maximizeAssetManager||e.galleryObserverEnable)];case 2:return n.sent(),[2,j.Maybe.maybe(e).map(function(e){return e.viewerSettings}).caseOf({just:function(e){return t.widget.applyViewerSettings(e)},nothing:function(){return t.widget.customersCanvasPromise}})]}})})},t.prototype.load=function(e,t,n){return Object(r.b)(this,void 0,void 0,function(){var i,s,o,a,c;return Object(r.e)(this,function(r){switch(r.label){case 0:return i=this,e.surfaces&&Array.isArray(e.surfaces)&&e.surfaces.forEach(function(e){"object"==typeof e&&void 0!==e.width&&void 0!==e.height&&(e.width=Number(e.width),e.height=Number(e.height))}),i.widget.modifiedItem&&i.widget.updateModifiedItem({}),s=this.widget.shadowRoot.querySelector("#design-editor"),[4,CustomersCanvas.IframeApi.loadEditor(s,e,t)];case 1:o=r.sent(),this.listenBoundsChanges(o),r.label=2;case 2:return r.trys.push([2,5,,6]),[4,o.getProduct()];case 3:return[4,(a=r.sent()).switchTo(a.surfaces[0])];case 4:return a=r.sent(),[3,6];case 5:return c=r.sent(),console.error("Load failed with exception: ",c),i.widget.dispatchEvent(new CustomEvent("error",c)),[2];case 6:return i.listenItemChanges(o),i.listenSurfaceChanges(o),i.widget.customersCanvasPublish(o),i.widget.dispatchEvent(new CustomEvent("ready",{detail:{product:a,customersCanvas:o}})),[4,this.widget.replaceInterpolationPlaceholder()];case 7:return r.sent(),n&&(i.listenModalClose(o),i.listenModalOpen(o),i.listenAssetManagerClose(o),i.listenAssetManagerOpen(o)),i.listenOriginalSize(o),i.listenFullWindow(o),i.listenRevertProduct(o),i.listenItemAdded(o),i.listenItemRemoved(o),[2]}})})},t.prototype.listenItemChanges=function(e){var t=this;e.subscribe(I.a.ItemChanged,function(e){return Object(r.b)(t,void 0,void 0,function(){var t;return Object(r.e)(this,function(n){switch(n.label){case 0:if(y.a.isNullOrUndefined(e))return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.widget.getDesignEditorItemModel(e)];case 2:return t=n.sent(),this.widget.updateModifiedItem(t),[3,4];case 3:return n.sent(),console.warn("Failed to transform item model"),[3,4];case 4:return this.widget.params.initial&&this.widget.params.initial.onItemChanged?[4,y.a.functionWrapperConstructor(this.widget.params.initial.onItemChanged)()]:[3,6];case 5:n.sent(),n.label=6;case 6:return[2]}})})})},t.prototype.listenItemAdded=function(e){var t=this;e.subscribe(I.a.ItemAdded,function(){return Object(r.b)(t,void 0,void 0,function(){return Object(r.e)(this,function(e){switch(e.label){case 0:return this.widget.params.initial&&this.widget.params.initial.onItemAdded?[4,y.a.functionWrapperConstructor(this.widget.params.initial.onItemAdded)()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.listenItemRemoved=function(e){return Object(r.b)(this,void 0,void 0,function(){var t=this;return Object(r.e)(this,function(n){return e.subscribe(I.a.ItemRemoved,function(){return Object(r.b)(t,void 0,void 0,function(){return Object(r.e)(this,function(e){switch(e.label){case 0:return this.widget.params.initial&&this.widget.params.initial.onItemRemoved?[4,y.a.functionWrapperConstructor(this.widget.params.initial.onItemRemoved)()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})}),[2]})})},t.prototype.listenBoundsChanges=function(e){var t=this;e.subscribe(I.a.BoundsNotification,function(e){t.widget.updateOverallBounds(e.overallBounds)})},t.prototype.listenSurfaceChanges=function(e){var t=this;e.subscribe(I.a.OnSurfaceChanged,function(e){t.widget.updateCurrentSurfaceName(),t.widget.updateCurrentSurfaceIndex()})},t.prototype.listenOriginalSize=function(e){var t=this;e.subscribe(I.a.OriginalSize,function(){t.widget.toggleMaximizeMainPanel(!1)})},t.prototype.listenFullWindow=function(e){var t=this;e.subscribe(I.a.FullWindow,function(){t.widget.toggleMaximizeMainPanel(!0)})},t.prototype.listenModalClose=function(e){var t=this;e.subscribe(I.a.ModalClose,function(){t.widget.toggleMaximizeMainPanel(!1)})},t.prototype.listenModalOpen=function(e){var t=this;e.subscribe(I.a.ModalOpen,function(){t.widget.toggleMaximizeMainPanel(!0)})},t.prototype.listenAssetManagerClose=function(e){var t=this;e.subscribe(I.a.AssetManagerClosed,function(){t.widget.toggleMaximizeMainPanel(!1)})},t.prototype.listenAssetManagerOpen=function(e){var t=this;e.subscribe(I.a.AssetManagerOpened,function(){t.widget.toggleMaximizeMainPanel(!0)})},t.prototype.listenRevertProduct=function(e){var t=this;e.subscribe(I.a.RevertProduct,function(e){return Object(r.b)(t,void 0,void 0,function(){return Object(r.e)(this,function(e){switch(e.label){case 0:return this.widget.params.initial&&this.widget.params.initial.onProductRevert?[4,y.a.functionWrapperConstructor(this.widget.params.initial.onProductRevert)()]:[3,2];case 1:e.sent(),this.widget.emitChange(),e.label=2;case 2:return[2]}})})})},t}(O),_=n(417),x=n(450),S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.d)(t,e),t.prototype.execute=function(e){return Object(r.b)(this,void 0,void 0,function(){var t,n,i,s,o,a,c,u,l,d,h,f,p,g,m,b,v,w,O;return Object(r.e)(this,function(P){switch(P.label){case 0:return t=Array.isArray(e)?e:[e],[4,this.widget.getEditor()];case 1:return[4,(n=P.sent()).getProduct()];case 2:i=P.sent(),P.label=3;case 3:P.trys.push([3,15,16,17]),s=Object(r.k)(t),o=s.next(),P.label=4;case 4:return o.done?[3,14]:(a=o.value).url?[4,i.getProductModel()]:[3,13];case 5:return c=P.sent(),(void 0===(u=a.surfaceIndex)||null===u||u<0||u>i.surfaces.length)&&(u=1===t.length?i.currentSurfaceIndex:t.indexOf(a)),l=c.surfaces.get(u),y.a.isNullOrUndefined(l)?[3,13]:(d=l.printAreas.get(0),h=l.containers.first(function(e){return e.name===_.a.BG_CONTAINER_NAME}),f=h.items.get(0),y.a.isNullOrUndefined(f)&&((f=new window.CustomersCanvas.DesignAtoms.ObjectModel.PlaceholderItem).locked=!0,h.items.add(f)),y.a.isNullOrUndefined(f.content)&&(f.content=new window.CustomersCanvas.DesignAtoms.ObjectModel.ImageItem),p=f.content,a.url.startsWith("public:")||a.url.startsWith("user:")?[4,n.configuration.getImageMetadata(a.url)]:[3,11]);case 6:if(g=P.sent(),(a.url.endsWith(".pdf")||a.url.endsWith(".svg"))&&(g.isVector=!0),!0!==a.toTile)return[3,8];if((m=f.content||f).sourceRectangle.width=g.size.width,m.sourceRectangle.height=g.size.height,m.setData)try{m.setData(g)}catch(e){x.a.setDataToImage(g,m)}else x.a.setDataToImage(g,m);return m.source.isVector=g.isVector,h.items.setRange(this._getTiles(m,l)),[4,i.setProductModel(c)];case 7:return P.sent(),[3,10];case 8:return i.surfaces.length>u?[4,i.surfaces[u].changeBackground(g)]:[3,10];case 9:P.sent(),P.label=10;case 10:return[3,13];case 11:return(b=new window.CustomersCanvas.DesignAtoms.ObjectModel.ImageItem.ImageSource).url=a.url,b.isVector=this._isVector(a.url),p.source=b,a.autoResize&&(l.width=p.sourceRectangle.width,l.height=p.sourceRectangle.height,d.bounds.width=l.width,d.bounds.height=l.height),!0===a.toTile&&h.items.setRange(this._getTiles(p,l)),[4,i.setProductModel(c)];case 12:P.sent(),P.label=13;case 13:return o=s.next(),[3,4];case 14:return[3,17];case 15:return v=P.sent(),w={error:v},[3,17];case 16:try{o&&!o.done&&(O=s.return)&&O.call(s)}finally{if(w)throw w.error}return[7];case 17:return[4,this.widget.ready()];case 18:return P.sent(),[2]}})})},t.prototype._getTiles=function(e,t){for(var n=[],r=0,i=0;i<t.height;){for(;r<t.width;){var s=e.clone();s.values=[],s.transform.setTranslateX(r),s.transform.setTranslateY(i),s.locked=!0,n.push(s),r+=e.source.width}r=0,i+=e.source.height}return n},t.prototype._isVector=function(e){return e.endsWith(".pdf")||e.endsWith(".svg")},t}(O),A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.d)(t,e),t.prototype.execute=function(e){return Object(r.b)(this,void 0,void 0,function(){var t,n,i,s;return Object(r.e)(this,function(r){switch(r.label){case 0:return[4,this.widget.getProduct()];case 1:t=r.sent(),Array.isArray(e)||(e=[e]),n=0,r.label=2;case 2:return n<e.length?(i=e[n]).data?(s=t.currentSurface,"number"==typeof i.surfaceIndex&&(s=t.surfaces[i.surfaceIndex]),[4,s.setPrintAreas([i.data],i.options)]):[3,5]:[3,6];case 3:return t=r.sent(),[4,this.widget.replaceInterpolationPlaceholder()];case 4:r.sent(),r.label=5;case 5:return n++,[3,2];case 6:return[2]}})})},t}(O),M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.d)(t,e),t.prototype.execute=function(e){return Object(r.b)(this,void 0,void 0,function(){var t,n,i,s,o,a,c,u,l,d,h,f,p,g;return Object(r.e)(this,function(m){switch(m.label){case 0:return null==e?[2,Promise.resolve()]:[4,this.widget.getEditor()];case 1:return[4,(t=m.sent()).getProduct()];case 2:return[4,(n=m.sent()).getProductModel()];case 3:i=m.sent(),m.label=4;case 4:m.trys.push([4,9,10,11]),s=Object(r.k)(e),o=s.next(),m.label=5;case 5:return o.done?[3,8]:(a=o.value,y.a.isNullOrUndefined(a.url)||""===a.url?[3,7]:(c="number"==typeof a.surfaceIndex?i.surfaces.get(a.surfaceIndex):i.surfaces.first(function(e){return e.name===n.currentSurface.name}),(u="up"===a.mockup.toLowerCase()?c.mockup.overContainers:c.mockup.underContainers).empty?(console.warn("Cannot set mockup because MockupContainer is empty"),[3,7]):((l=u.get(0)).items.clear(),d=new window.CustomersCanvas.DesignAtoms.ObjectModel.ImageItem,[4,t.configuration.getImageMetadata(a.url)])));case 6:if((h=m.sent()).size={width:h.size.width||h.width,height:h.size.height||h.height},d.setData)try{d.setData(h)}catch(e){x.a.setDataToImage(h,d)}else x.a.setDataToImage(h,d);d.ratioWidthToHeight=l.size.width/l.size.height,d.SetWidth(l.size.width,!1),d.SetHeight(l.size.height,!1),l.items.add(d),m.label=7;case 7:return o=s.next(),[3,5];case 8:return[3,11];case 9:return f=m.sent(),p={error:f},[3,11];case 10:try{o&&!o.done&&(g=s.return)&&g.call(s)}finally{if(p)throw p.error}return[7];case 11:return[4,n.setProductModel(i)];case 12:return m.sent(),[2]}})})},t}(O),E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.d)(t,e),t.prototype.execute=function(e){return Object(r.b)(this,void 0,void 0,function(){return Object(r.e)(this,function(t){switch(t.label){case 0:return"string"==typeof e?e={theme:e}:void 0===e.theme&&(e={theme:e}),[4,this.widget.getProduct()];case 1:return[4,t.sent().applyProductTheme(e.theme)];case 2:return[2,t.sent()]}})})},t}(O),R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.d)(t,e),t.prototype.execute=function(e){return Object(r.b)(this,void 0,void 0,function(){var t,n,i,s,o,a,c,u,l,d,h,f,p,g,m,b,v,y;return Object(r.e)(this,function(w){switch(w.label){case 0:return null!=e&&e instanceof Array?[4,this.widget.getProduct()]:[2];case 1:t=w.sent(),w.label=2;case 2:w.trys.push([2,14,15,16]),n=Object(r.k)(e),i=n.next(),w.label=3;case 3:if(i.done)return[3,13];if(s=i.value,o=e.indexOf(s),null==(a=t.surfaces[o]))return[3,12];w.label=4;case 4:w.trys.push([4,10,11,12]),v=void 0,c=Object(r.k)(Object.entries(s)),u=c.next(),w.label=5;case 5:return u.done?[3,9]:(l=Object(r.h)(u.value,2),d=l[0],h=l[1],null==(f=a.printAreas[0].getContainer(d))?[3,7]:[4,f.update(h)]);case 6:return w.sent(),[3,8];case 7:console.warn("Container with name "+d+" was not found!"),w.label=8;case 8:return u=c.next(),[3,5];case 9:return[3,12];case 10:return p=w.sent(),v={error:p},[3,12];case 11:try{u&&!u.done&&(y=c.return)&&y.call(c)}finally{if(v)throw v.error}return[7];case 12:return i=n.next(),[3,3];case 13:return[3,16];case 14:return g=w.sent(),m={error:g},[3,16];case 15:try{i&&!i.done&&(b=n.return)&&b.call(n)}finally{if(m)throw m.error}return[7];case 16:return[2]}})})},t}(O),D=n(383),T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.d)(t,e),t.prototype.execute=function(e,t){return Object(r.b)(this,void 0,void 0,function(){var n,i;return Object(r.e)(this,function(r){switch(r.label){case 0:return y.a.isEmptyObject(e)||y.a.isEmptyObject(e.every)&&y.a.isEmptyObject(e.items)?[2,Promise.resolve()]:(e.items=e.items||{},y.a.isNotNullOrUndefined(t)&&(e=this._removeOldParams(e,t)),[4,this.widget.getEditor()]);case 1:return[4,(n=r.sent()).getProduct()];case 2:return i=r.sent(),[4,this._modifyItems(e,i,n)];case 3:return r.sent(),[4,this._applyUserInfo(n,e)];case 4:return r.sent(),[2]}})})},t.prototype._modifyItems=function(e,t,n){return Object(r.b)(this,void 0,void 0,function(){var i,s,o,a,c,u,l,d,h,f;return Object(r.e)(this,function(p){switch(p.label){case 0:return y.a.isNullOrUndefined(e)?[2]:y.a.isNotNullOrUndefined(e.items)?[4,this._applyBackgroundColor(e,t)]:[3,2];case 1:p.sent(),p.label=2;case 2:return[4,t.getProductModel()];case 3:i=p.sent(),s=i.getAllItems({ignoreMockups:!0,flatGroupItems:!0,excludeGroupItems:!0}),p.label=4;case 4:p.trys.push([4,13,14,15]),o=Object(r.k)(s),a=o.next(),p.label=5;case 5:return a.done?[3,12]:(c=a.value,u=Object(r.a)(Object(r.a)({},e.every),e.items[c.name]),0===Object.keys(u).length?[3,11]:this.needApplyOnce(u,c)?this._isTextItem(c.type)?(this._updateTextItem(u,c),[3,10]):[3,6]:[3,11]);case 6:return c.type!==D.PlaceholderItem.type?[3,8]:[4,this._updatePlaceholderItem(u,c,n)];case 7:return p.sent(),[3,10];case 8:return c.type!==D.ShapeItem.type?[3,10]:[4,this._updateShapeItem(u,c)];case 9:p.sent(),p.label=10;case 10:this._updateVisualizationPermissions(u,c),this.setApplyOnce(u,c),p.label=11;case 11:return a=o.next(),[3,5];case 12:return[3,15];case 13:return l=p.sent(),h={error:l},[3,15];case 14:try{a&&!a.done&&(f=o.return)&&f.call(o)}finally{if(h)throw h.error}return[7];case 15:return d=t.currentSurfaceIndex>0?t.currentSurfaceIndex:0,[4,t.setProductModel(i)];case 16:return p.sent(),[4,n.getProduct()];case 17:return[4,(t=p.sent()).switchTo(t.surfaces[d])];case 18:return p.sent(),[2]}})})},t.prototype.needApplyOnce=function(e,t){return!(!0===e.once&&t&&t.tags.modifyItems&&!0===t.tags.modifyItems.once)},t.prototype.setApplyOnce=function(e,t){!0===e.once&&t&&(t.tags.modifyItems=t.tags.modifyItems||{},t.tags.modifyItems.once=!0)},t.prototype._isTextItem=function(e){return e===D.BaseTextItem.type||e===D.BoundedTextItem.type||e===D.PlainTextItem.type||e===D.CurvedTextItem.type||e===D.AutoScaledTextItem.type},t.prototype._removeOldParams=function(e,t){for(var n in e.items){var r=t.items[n],i=e.items[n];JSON.stringify(r)===JSON.stringify(i)&&!0!==i.force&&delete e.items[n]}return e},t.prototype._applyBackgroundColor=function(e,t){return Object(r.b)(this,void 0,void 0,function(){var n,i,s,o,a,c,u;return Object(r.e)(this,function(l){switch(l.label){case 0:if(null==(n=e.items.background||e.items.Background)||null==n.color)return[3,8];if(null===(i=window.CustomersCanvas.DesignAtoms.ObjectModel.ColorFactory.createColor(n.color)))return[3,8];l.label=1;case 1:l.trys.push([1,6,7,8]),s=Object(r.k)(t.surfaces),o=s.next(),l.label=2;case 2:return o.done?[3,5]:[4,o.value.changeBackground(i)];case 3:l.sent(),l.label=4;case 4:return o=s.next(),[3,2];case 5:return[3,8];case 6:return a=l.sent(),c={error:a},[3,8];case 7:try{o&&!o.done&&(u=s.return)&&u.call(s)}finally{if(c)throw c.error}return[7];case 8:return[2]}})})},t.prototype._updateTextItem=function(e,t){var n=e.text||e.value;if(null!=n&&(t.text=n),t.placeholders&&t.placeholders.length>0&&(t.placeholders.forEach(function(e){return e.value=n}),t.value=n),null!=e.font){var r=e.font.bold||e.font.fauxBold;r&&(t.font.fauxBold=r);var i=e.font.italic||e.font.fauxItalic;i&&(t.font.fauxItalic=i);var s=e.font.family||e.font.postScriptName;s&&(t.font.postScriptName=s),e.font.size&&(t.font.size=e.font.size),e.font.underline&&(t.underline=e.font.underline);var o=e.color||e.font.color;o&&(t.color=window.CustomersCanvas.DesignAtoms.ObjectModel.ColorFactory.createColor(o))}if((!0===e.locked&&(t.textPermissions.allowChangeText=!1,t.textPermissions.allowChangeTextBIU=!1),t.type===D.PlainTextItem.type)&&(l=e.position||e.location)){var a=0,c=0,u=t;t.alignment=D.TextAlignment.Left,l||(l={x:0,y:0}),a=l.x||u.baselineLocation.x,c=l.y||u.baselineLocation.y,u.baselineLocation=new window.CustomersCanvas.DesignAtoms.ObjectModel.PointF(a,c)}if(t.type===D.BoundedTextItem.type||t.type===D.AutoScaledTextItem.type){var l,d=t;if((l=e.position||e.location)||e.size){var h,f;a=0,c=0;l||(l={x:0,y:0}),a=l.x||d.textRectangle.left,c=l.y||d.textRectangle.top,e.size||(e.size={width:0,height:0}),h=e.size.width||d.textRectangle.width,f=e.size.height||d.textRectangle.height,d.textRectangle.width=h,d.textRectangle.height=f,d.textRectangle.left=a,d.textRectangle.top=c}}},t.prototype._updateVisualizationPermissions=function(e,t){e.visualizationPermissions&&(y.a.isNotNullOrUndefined(e.visualizationPermissions.noPrint)&&(t.visualizationPermissions.noPrint=e.visualizationPermissions.noPrint),y.a.isNotNullOrUndefined(e.visualizationPermissions.noShow)&&(t.visualizationPermissions.noShow=e.visualizationPermissions.noShow)),y.a.isNotNullOrUndefined(e.locked)&&(t.locked=e.locked)},t.prototype._updatePlaceholderItem=function(e,t,n){return Object(r.b)(this,void 0,void 0,function(){var i,s,o,a,c,u,l,d,h,f,p,g;return Object(r.e)(this,function(r){switch(r.label){case 0:return i=function(e){return e.placeholderContent&&e.tags&&e.tags.sourceData&&e.value===e.tags.sourceData.name},"ImagePlaceholder"!==e.type?[3,6]:i(e)?-1!==e.placeholderContent.originalUrl.indexOf("?x-cctoken=")?[3,2]:[4,this.widget.getToken()]:[3,4];case 1:""!==(s=r.sent())&&(e.placeholderContent.originalUrl+="?x-cctoken="+s),r.label=2;case 2:return o=e.placeholderContent.originalUrl,e.tags.sourceData.originalUrl=o,[4,n.configuration.getImageMetadata(o)];case 3:if(a=r.sent(),f=t.content,t.isStubContent=!1,f.setData)try{f.setData(a)}catch(e){x.a.setDataToImage(a,f)}else x.a.setDataToImage(a,f);return f.tags=e.tags,f.parentPlaceholder=t,p=new b.a(t),(g=new m.a(f)).updateRectangle(!1,t.contentResizeMode,p),c=p.getTransformedRectangle(),u=e.placeholderContent,(c.angle!==u.placeholderRectangle.angle||c.width!==u.placeholderRectangle.width||c.height!==u.placeholderRectangle.height||c.centerX!==u.placeholderRectangle.centerX||c.centerY!==u.placeholderRectangle.centerY)&&(l=new window.CustomersCanvas.DesignAtoms.ObjectModel.RotatedRectangleF(u.placeholderRectangle.centerX,u.placeholderRectangle.centerY,u.placeholderRectangle.width,u.placeholderRectangle.height,u.placeholderRectangle.angle),p.setTransformedRectangle(l)),d=g.getTransformedRectangle(),(d.angle!==u.contentRectangle.angle||d.width!==u.contentRectangle.width||d.height!==u.contentRectangle.height||d.centerX!==u.contentRectangle.centerX||d.centerY!==u.contentRectangle.centerY)&&(h=new window.CustomersCanvas.DesignAtoms.ObjectModel.RotatedRectangleF(u.contentRectangle.centerX,u.contentRectangle.centerY,u.contentRectangle.width,u.contentRectangle.height,u.contentRectangle.angle),g.setTransformedRectangle(h)),[3,5];case 4:if(!t.isStubContent){if((f=t.content).parentPlaceholder=t,f.setData)try{f.setData(t.stubStorageMeta)}catch(e){x.a.setDataToImage(t.stubStorageMeta,f)}else x.a.setDataToImage(t.stubStorageMeta,f);p=new b.a(t),(g=new m.a(f)).parentPlaceholder=p,g.updateRectangle(!1,t.contentResizeMode,p),t.isStubContent=!0}r.label=5;case 5:e.contentPermissions&&e.contentPermissions.imagePermissions&&(t.contentPermissions.imagePermissions.allowChangeImage=e.contentPermissions.imagePermissions.allowChangeImage,t.contentPermissions.imagePermissions.allowEditImage=e.contentPermissions.imagePermissions.allowEditImage),e.placeholderPermissions&&(t.placeholderPermissions.allowEditContent=e.placeholderPermissions.allowEditContent,t.placeholderPermissions.showHandleButton=e.placeholderPermissions.showHandleButton,t.placeholderPermissions.showSelectButton=e.placeholderPermissions.showSelectButton),r.label=6;case 6:return"BarcodePlaceholder"===e.type&&(e.value||t.isStubContent||(t.content.applyBarcodeData(new window.CustomersCanvas.DesignAtoms.ObjectModel.BarcodeData("")),t.isStubContent=!0)),[2]}})})},t.prototype._updateShapeItem=function(e,t){return Object(r.b)(this,void 0,void 0,function(){var n,i,s,o,a,c;return Object(r.e)(this,function(r){return(n=e.color||e.fillColor)&&(t.fillColor=window.CustomersCanvas.DesignAtoms.ObjectModel.ColorFactory.createColor(n)),((i=e.position||e.location)||e.size)&&(s=0,o=0,a=0,c=0,i||(i={x:0,y:0}),s=i.x||t.sourceRectangle.left,o=i.y||t.sourceRectangle.top,e.size||(e.size={width:0,height:0}),a=e.size.width||t.sourceRectangle.width,c=e.size.height||t.sourceRectangle.height,t.sourcePath=window.CustomersCanvas.DesignAtoms.ObjectModel.Path.rectangle(s,o,a,c)),[2]})})},t.prototype._applyUserInfo=function(e,t){return Object(r.b)(this,void 0,void 0,function(){var n,i,s,o,a,c,u,l,d,h,f,p;return Object(r.e)(this,function(g){switch(g.label){case 0:return n=function(e){return!!e.placeholderContent&&e.tags&&e.tags.sourceData&&e.value===e.tags.sourceData.name},[4,e.getProduct()];case 1:return[4,g.sent().getProductModel()];case 2:i=g.sent(),s=i.getAllItems({ignoreMockups:!0,flatGroupItems:!0,excludeGroupItems:!0}),o={},a=function(e){var r=t.items[e],i=s.find(function(t){return t.name===e});return c.needApplyOnce(r,i)&&(r.value||"Text"===r.type||"InString"===r.type||r.image)?"ImagePlaceholder"===r.type&&n(r)?"continue":("BarcodePlaceholder"===r.type?r.barcodeSubType&&"None"!==r.barcodeSubType?"Url"===r.barcodeSubType?o[e]={BarcodeFormat:r.barcodeFormat,BarcodeSubType:r.barcodeSubType,Url:r.value}:"Phone"===r.barcodeSubType&&(o[e]={barcodeFormat:r.barcodeFormat,barcodeSubType:r.barcodeSubType,phone:r.value}):o[e]={barcodeFormat:r.barcodeFormat,barcodeValue:r.value}:o[e]=y.a.isNotNullOrUndefined(r.value)?r.value:r.image,void c.setApplyOnce(r,i)):"continue"},c=this;try{for(u=Object(r.k)(Object.keys(t.items)),l=u.next();!l.done;l=u.next())d=l.value,a(d)}catch(e){f={error:e}}finally{try{l&&!l.done&&(p=u.return)&&p.call(u)}finally{if(f)throw f.error}}if(y.a.isEmptyObject(o))return[2,Promise.resolve()];g.label=3;case 3:return g.trys.push([3,5,,6]),[4,e.loadUserInfo(o)];case 4:return g.sent(),[3,6];case 5:return h=g.sent(),this.widget.showToast("Error: Invalid data"),console.log(h),[3,6];case 6:return[2]}})})},t}(O),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.d)(t,e),t.prototype.execute=function(e){return Object(r.b)(this,void 0,void 0,function(){var t,n;return Object(r.e)(this,function(r){switch(r.label){case 0:return e?[4,this.widget.getEditor()]:[3,3];case 1:return t=r.sent(),n=Object.assign({},e),null!=e.scrollPosition&&(n.scrollingPosition={x:e.scrollPosition.X||e.scrollPosition.x,y:e.scrollPosition.Y||e.scrollPosition.y}),[4,t.setViewerSettings(n)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},t}(O),z=n(384),N=n(584),U=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._configProcessor=new N.a,t}return Object(r.d)(t,e),t.prototype.execute=function(e){return Object(r.b)(this,void 0,void 0,function(){var t,n,i,s,o,a,c,u,l,d;return Object(r.e)(this,function(h){switch(h.label){case 0:return t=this._configProcessor.process(e,{}),[4,this.widget.getProduct()];case 1:return[4,(n=h.sent()).getProductModel()];case 2:return[4,(i=h.sent()).getAllItems({ignoreMockups:!0,flatGroupItems:!0,excludeGroupItems:!0})];case 3:s=h.sent();try{for(o=Object(r.k)(s),a=o.next();!a.done;a=o.next())c=a.value,u=t.items[c.name],y.a.isNotNullOrUndefined(u)||Object(z.f)(c,u)}catch(e){l={error:e}}finally{try{a&&!a.done&&(d=o.return)&&d.call(o)}finally{if(l)throw l.error}}return[4,n.setProductModel(i)];case 4:return h.sent(),[2]}})})},t}(O),F=n(471),B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._serializer=new F.a,t}return Object(r.d)(t,e),t.prototype.execute=function(e){return Object(r.b)(this,void 0,void 0,function(){var t;return Object(r.e)(this,function(n){switch(n.label){case 0:if(Object(z.l)(e.serializedProduct))throw"serializedProduct cannot be null or empty";return t=this._serializer.deserialize(e.serializedProduct),[4,this.widget.getProduct()];case 1:return[4,n.sent().setProductModel(t)];case 2:return n.sent(),[2]}})})},t}(O),W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.d)(t,e),t.prototype.execute=function(e){return Object(r.b)(this,void 0,void 0,function(){return Object(r.e)(this,function(t){switch(t.label){case 0:return e&&e.surfaces&&0!==e.surfaces.length?e.surfaces.some(function(e){return 0===Object.keys(e).length})?[2]:[4,this.widget.getEditor()]:[2];case 1:return[4,t.sent().getProduct()];case 2:return[4,t.sent().setSurfaces(e.surfaces)];case 3:return t.sent(),[4,this.widget.replaceInterpolationPlaceholder()];case 4:return t.sent(),[2]}})})},t}(O),G=n(418),V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.d)(t,e),t.prototype.execute=function(e){return Object(r.b)(this,void 0,void 0,function(){var t,n,i,s,o,a;return Object(r.e)(this,function(r){switch(r.label){case 0:return e&&e.resizeParams&&0!==e.resizeParams.height&&0!==e.resizeParams.width?[4,this.widget.getEditor()]:[2];case 1:return t=r.sent(),(n=e.resizeParams).targets&&n.targets.length>0&&"string"==typeof n.targets[0]?[4,t.getProduct()]:[3,6];case 2:return[4,r.sent().getProductModel()];case 3:return[4,r.sent().getAllItems({ignoreMockups:!0,flatGroupItems:!0,excludeGroupItems:!0})];case 4:return i=r.sent(),s=i.filter(function(e){return n.targets.includes(e.name)}).map(function(e){return e.id}),(o=e.resizeParams).targetIds=s,[4,t.commandManager.execute(G.c.resize,o)];case 5:return r.sent(),[3,8];case 6:return("product"===e.resizeParams.targetType||!e.resizeParams.targetIds&&0!==e.resizeParams.targetIds.length)&&(null!==e.resizeParams.target&&void 0!==e.resizeParams.target||"product"===e.resizeParams.targetType)?(a=e.resizeParams,[4,t.commandManager.execute(G.c.resize,a)]):[2];case 7:r.sent(),r.label=8;case 8:return[4,this.widget.ready()];case 9:return r.sent(),[2]}})})},t}(O),J=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.d)(t,e),t.prototype.execute=function(e){return Object(r.b)(this,void 0,void 0,function(){var t,n,i,s,o,a,c,u,l,d;return Object(r.e)(this,function(r){switch(r.label){case 0:return e&&e.translateParams?(t=e.translateParams,n=t.itemIds&&t.itemIds.length>0,i=e.translateParams,s=i.items&&0===i.items.length&&"string"!=typeof i.items[0],o=e.translateParams,a=o.items&&o.items.length>0&&"string"==typeof o.items[0],n||s||a?[4,this.widget.getEditor()]:[2]):[2];case 1:return c=r.sent(),a?[4,c.getProduct()]:[3,6];case 2:return[4,r.sent().getProductModel()];case 3:return[4,r.sent().getAllItems({ignoreMockups:!0,flatGroupItems:!0,excludeGroupItems:!0})];case 4:return u=r.sent(),l=u.filter(function(e){return o.items.includes(e.name)}).map(function(e){return e.id}),d={itemIds:l,translateX:o.translateX,translateY:o.translateY},[4,c.commandManager.execute(G.b.translateItems,d)];case 5:return r.sent(),[3,8];case 6:return[4,c.commandManager.execute(G.b.translateItems,e.translateParams)];case 7:r.sent(),r.label=8;case 8:return[4,this.widget.ready()];case 9:return r.sent(),[2]}})})},t}(O),H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.d)(t,e),t.prototype.execute=function(e){return Object(r.b)(this,void 0,void 0,function(){var t,n,i,s,o,a,c,u;return Object(r.e)(this,function(l){switch(l.label){case 0:if(0===(t=(Array.isArray(e)?e:[e]).filter(function(e){return e})).length)return[2];l.label=1;case 1:l.trys.push([1,9,10,11]),n=Object(r.k)(t),i=n.next(),l.label=2;case 2:return i.done?[3,8]:(s=i.value,[4,this.widget.getProduct()]);case 3:return(o=l.sent()).updateSurfaces?1!==o.updateSurfaces.length?[3,5]:[4,o.updateSurfaces(s)]:(console.warn("Command unavailable for this version Customer's Canvas. Please, use version 6.2.0 or above."),[2]);case 4:return l.sent(),[3,7];case 5:return[4,o.updateSurfaces(s.productDefinition||s.definition,s.options,s.sourceSurfaceIndexes,s.targetSurfaceIndexes)];case 6:l.sent(),l.label=7;case 7:return i=n.next(),[3,2];case 8:return[3,11];case 9:return a=l.sent(),c={error:a},[3,11];case 10:try{i&&!i.done&&(u=n.return)&&u.call(n)}finally{if(c)throw c.error}return[7];case 11:return[2]}})})},t}(O),L=n(511),X=n(1),Y=n(16),q=n(512),K=function(){function e(){this.promise=new Promise(function(e,t){this._resolve=e,this._reject=t}.bind(this))}return e.prototype.then=function(e){return this.promise.then(e)},e.prototype.catch=function(e){return this.promise.catch(e)},e.prototype.resolve=function(e){void 0===e&&(e=""),this._resolve(e)},e.prototype.reject=function(e){this._reject(e)},e}(),Z=n(206),$=n(580),Q=n(931),ee=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._isRestoring=!1,t.CC_SCRIPT_RELATIVE_PATH="/Resources/Generated/IframeApi.js",t.modifiedItem=null,t._currentSurfaceName="",t._currentSurfaceIndex=0,t._surfaceCount=0,t.overallBounds={},t._hiResUrls=[],t._proofImageUrls=[[]],t._proofPdfUrls=[],t._stateId="",t._userId="",t._userChanges={},t._variableData=[],t._allItems=[],t._depositPhotos=[],t._tags={},t._identifyingString="",t._lastParams={},t._currentParams={},t.actionsFinished=!1,t.actionsFinishedPromise=new K,t.commands={initial:new C(t),changeMockup:new P(t),setPrintArea:new A(t),setTheme:new E(t),setBackground:new S(t),updateContainerSettings:new R(t),setRemoteMockup:new M(t),modifyItems:new T(t),setViewerSettings:new k(t),updateItems:new U(t),setSerializedProduct:new B(t),setSurfaces:new W(t),resize:new V(t),translate:new J(t),updateSurfaces:new H(t)},t.itemsData={},t._token="",t}return Object(r.d)(t,e),Object.defineProperty(t.prototype,"violationWarningData",{get:function(){return this._violationWarningData},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"boundsData",{get:function(){return this._boundsData},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentSurfaceName",{get:function(){return this._currentSurfaceName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentSurfaceIndex",{get:function(){return this._currentSurfaceIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"surfaceCount",{get:function(){return this._surfaceCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"proofImageUrls",{get:function(){return this._proofImageUrls},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"proofPdfUrls",{get:function(){return this._proofPdfUrls},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hiResUrls",{get:function(){return this._hiResUrls},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stateId",{get:function(){return this._stateId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userChanges",{get:function(){return this._userChanges},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userId",{get:function(){return this._userId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allItems",{get:function(){return this._allItems},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"variableData",{get:function(){return this._variableData},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"depositPhotos",{get:function(){return this._depositPhotos},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tags",{get:function(){return this._tags},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"identifyingString",{get:function(){return this._identifyingString},enumerable:!1,configurable:!0}),t.prototype.calculateIdentifyingString=function(e){return Object(r.b)(this,void 0,void 0,function(){var t,n,i,s,o;return Object(r.e)(this,function(r){switch(r.label){case 0:return[4,this.getProduct()];case 1:return[4,r.sent().getProductModel()];case 2:return[4,r.sent().getAllItems({ignoreMockups:!0,flatGroupItems:!0,excludeGroupItems:!0})];case 3:return t=r.sent(),n=new Q.a({titleTemplate:e}),i=function(e){var t="";switch(!0){case e instanceof CustomersCanvas.DesignAtoms.ObjectModel.BaseTextItem:t=Object(z.k)(e.text);break;case e instanceof CustomersCanvas.DesignAtoms.ObjectModel.BarcodeItem:t=e.barcodeContent}return{name:e.name,value:t}},s=t.reduce(function(e,t){var n=i(t);return e[n.name]=n.value,e},{}),o=n.buildTitle(s),this._identifyingString=o,this.emitChange(),[2,o]}})})},t.prototype.isInstanceOf=function(e,t){var n,r,i=function(e){var t=[];return e.__proto__&&(t=t.concat(i(e.__proto__))),t.push(function(e){return e.constructor.type}(e)),t.filter(function(e){return e})};return n=i(e),r=t,-1!==n.indexOf(r.type)},t.prototype.updateParams=function(e){if(void 0!==e.initial&&(e.initial.editorConfig||(e.initial.editorConfig={}),e.initial.editorConfig.defaultLanguage=this.driver.config.language||"en",this.driver)){this._initialOrder=this._initialOrder||Object(v.a)(this.driver.orders[0]);var t=this.driver.user.id;t&&(e.initial.editorConfig.userId=t);var n=this.driver.user.tokenId;n&&(e.initial.editorConfig.tokenId=n);var r=this.auWizard.scopeInternal.widgetsData,i=r&&r[this.name]?r[this.name].stateId:this._initialOrder.data.stateId;i&&""!==i&&(e.initial.productDefinition=i),e.initial.editorConfig.preloader={enabled:!1}}},t.prototype.exportWidgetData=function(e){return Object(r.b)(this,void 0,void 0,function(){return Object(r.e)(this,function(t){switch(t.label){case 0:return!0!==e?[3,2]:[4,this.saveProduct()];case 1:t.sent(),t.label=2;case 2:return[2,{stateId:this._stateId}]}})})},t.prototype.restoreWidgetFromData=function(e,t){return void 0===t&&(t=!1),Object(r.b)(this,void 0,void 0,function(){var n;return Object(r.e)(this,function(r){switch(r.label){case 0:return!0!==t?[3,2]:((n=Object.assign({},this.params.initial)).productDefinition=e.stateId,[4,this.commands.initial.execute(n)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.updateParamsAsync=function(t){return Object(r.b)(this,void 0,void 0,function(){var n,i,s,o,a,c,u,l,d;return Object(r.e)(this,function(r){switch(r.label){case 0:return[4,e.prototype.updateParamsAsync.call(this,t)];case 1:if(r.sent(),0===(n=this._commandExecuter.getChangedActions(t,this._currentParams)).length)return[2,!1];-1!==n.indexOf("initial")&&(i=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/,s=y.a.isNotNullOrUndefined(this._stateId)&&""!==this._stateId,(o=y.a.isNotNullOrUndefined(t.initial.productDefinition)&&t.initial.productDefinition.toString().match(i))&&(this._isRestoring=!0),(s||o)&&(n=["initial"])),this.actionsFinishedPromise=new K,this.actionsFinished=!1,this._isRestoring||this.emitChange(),a=n.every(function(e){var n=t[e];return Array.isArray(t[e])&&(n=t[e][0]),!1===n.showPreloader}),c=1===n.length&&-1!==n.indexOf("initial"),a||this.showPreloader(!0,this.getPreloaderMessage(t,c)),this._currentParams=Object(v.a)(t),r.label=2;case 2:return r.trys.push([2,5,6,7]),this._isRestoring&&!c?[3,4]:[4,this._commandExecuter.executeActions(t,n,this._lastParams)];case 3:r.sent(),r.label=4;case 4:return[3,7];case 5:return u=r.sent(),this.params.actionsErrorToast&&!0===this.params.actionsErrorToast.show&&(l="widgets.canvas.actions.error",(d=this.localize(l))===l&&(d="Something went wrong. Send the website support team information about your browser and steps to reproduce the problem."),this.showToast(d,this.params.actionsErrorToast.duration)),this.logger.error(function(){return"Failed to perform an action on Design Editor. "},u),[3,7];case 6:return a||this.showPreloader(!1),this._lastParams=t,this.actionsFinishedPromise.resolve(),this.actionsFinished=!0,this._isRestoring&&(this.getInitialParamsResolved(),this._isRestoring=!1),this.getSurfaceCount(),[7];case 7:return[2]}})})},t.prototype.connectedCallback=function(){var t=this;e.prototype.connectedCallback.call(this),this._commandExecuter=new q.a(this.commands,this.uniqWidgetName),this.baseUrl=this.driver.settings.customersCanvasBaseUrl,this.showPreloader(!0),this.iframeApiPromise=L.a.loadCCScript(this.baseUrl,this.CC_SCRIPT_RELATIVE_PATH),this.iframeApiPromise.then(function(){t.showPreloader(!1),CustomersCanvas.IframeApi.editorUrl=t.baseUrl})},t.prototype.switchSurfaceTo=function(e){return Object(r.b)(this,void 0,void 0,function(){var t;return Object(r.e)(this,function(n){switch(n.label){case 0:return[4,this.getProduct()];case 1:return t=n.sent(),e<0||e>t.surfaces.length-1?(console.error("Invalid surface index: "+e),[2,t]):[4,t.switchTo(t.surfaces[e])];case 2:return[2,n.sent()]}})})},t.prototype.removeSurface=function(e){return Object(r.b)(this,void 0,void 0,function(){var t,n;return Object(r.e)(this,function(r){switch(r.label){case 0:return[4,this.getProduct()];case 1:return t=r.sent(),e<0||e>t.surfaces.length-1?(console.error("Invalid surface index: "+e),[2]):(n=t.surfaces[e],[4,t.removeSurface(n)]);case 2:return[2,r.sent()]}})})},t.prototype.addSurface=function(e,t){return Object(r.b)(this,void 0,void 0,function(){return Object(r.e)(this,function(n){switch(n.label){case 0:return[4,this.getProduct()];case 1:return[4,n.sent().addSurface(e,t)];case 2:return[2,n.sent()]}})})},t.prototype.addSurfaces=function(e,t){return Object(r.b)(this,void 0,void 0,function(){return Object(r.e)(this,function(n){switch(n.label){case 0:return[4,this.getProduct()];case 1:return[4,n.sent().addSurfaces(e,t)];case 2:return[2,n.sent()]}})})},t.prototype.updateSurfaces=function(e,t){return Object(r.b)(this,void 0,void 0,function(){var n;return Object(r.e)(this,function(r){switch(r.label){case 0:return[4,this.getProduct()];case 1:switch(n=r.sent(),e.toLowerCase()){case"remove":return[3,2];case"add":return[3,4]}return[3,6];case 2:return[4,this.removeSurface(t)];case 3:return n=r.sent(),[3,6];case 4:return[4,this.addSurface(t)];case 5:return n=r.sent(),[3,6];case 6:return[2,n]}})})},t.prototype.updateModifiedItem=function(e){Object($.a)(this.modifiedItem,e)||(this.modifiedItem=e,this.emitChange({modifiedItem:this.modifiedItem},!1))},t.prototype.updateOverallBounds=function(e){Object($.a)(this.overallBounds,e)||(this.overallBounds=e,this.emitChange({overallBounds:this.overallBounds},!1))},t.prototype.updateCurrentSurfaceName=function(){return Object(r.b)(this,void 0,void 0,function(){var e;return Object(r.e)(this,function(t){switch(t.label){case 0:return[4,this.getProduct()];case 1:return e=t.sent(),this._currentSurfaceName=e.currentSurface.name,this.emitChange(),[2]}})})},t.prototype.updateCurrentSurfaceIndex=function(){return Object(r.b)(this,void 0,void 0,function(){var e;return Object(r.e)(this,function(t){switch(t.label){case 0:return[4,this.getProduct()];case 1:return e=t.sent(),this._currentSurfaceIndex=e.surfaces.indexOf(e.currentSurface),this.emitChange(),[2]}})})},t.prototype.applyViewerSettings=function(e){return Object(r.b)(this,void 0,void 0,function(){return Object(r.e)(this,function(t){return[2,this.commands.setViewerSettings.execute(e)]})})},t.prototype.getProofImages=function(e,t,n,i,s,o,a,c){return void 0===e&&(e=800),void 0===t&&(t=800),void 0===n&&(n=!0),void 0===i&&(i=!1),void 0===s&&(s=!1),void 0===o&&(o=1e3),void 0===a&&(a=1e3),Object(r.b)(this,void 0,void 0,function(){var u,l,d,h;return Object(r.e)(this,function(r){switch(r.label){case 0:return[4,this.getEditor()];case 1:return u=r.sent(),l={},"object"==typeof n&&(c=n,n=!0),l="object"==typeof e?e:{maxWidth:e,maxHeight:t,pregeneratePreviewImages:n,generateProductProof:i,generateLargePreviews:s,largePreviewMaxWidth:o,largePreviewMaxHeight:a},[4,u.getProofImages(l,c)];case 2:return d=r.sent(),this._proofImageUrls=d.proofImageUrls,[4,u.getProduct()];case 3:return h=r.sent(),this._surfaceCount=h.surfaces.length,this.emitChange({urls:this.proofImageUrls},!0),[2,d.proofImageUrls.map(function(e){return e[0]})]}})})},t.prototype.getProofPdf=function(e){return Object(r.b)(this,void 0,void 0,function(){var t,n,i,s,o;return Object(r.e)(this,function(r){switch(r.label){case 0:return t={generateProductProof:!0},[4,this.getEditor()];case 1:return[4,(n=r.sent()).getProofImages(t,e)];case 2:return i=r.sent(),s=i.proofImageUrls.map(function(e){return e[0]}),this._proofPdfUrls=s.filter(function(e){return e.endsWith(".pdf")}),this._proofImageUrls=i.proofImageUrls.filter(function(e){return!e[0].endsWith(".pdf")}),[4,n.getProduct()];case 3:return o=r.sent(),this._surfaceCount=o.surfaces.length,this.emitChange({proofPdfUrls:this.proofPdfUrls,proofImageUrls:this.proofImageUrls},!0),[2,this._proofPdfUrls]}})})},t.prototype.getHiResImages=function(e,t,n,i,s,o){return void 0===e&&(e=800),void 0===t&&(t=800),void 0===i&&(i=!1),Object(r.b)(this,void 0,void 0,function(){var a,c,u;return Object(r.e)(this,function(r){switch(r.label){case 0:return[4,this.getEditor()];case 1:return a=r.sent(),null!==n&&""!==n||(n=void 0),null!==s&&""!==s||(s=void 0),"object"==typeof n&&(o=n,n=void 0),[4,a.finishProductDesign({stateId:n,proofMaxWidth:e,proofMaxHeight:t,pregeneratePreviewImages:i,fileName:s},o)];case 2:return c=r.sent(),this._stateId=c.stateId,this._userId=c.userId,this._hiResUrls=c.hiResOutputUrls,this._proofImageUrls=c.proofImageUrls,this._userChanges=c.userChanges,this._violationWarningData=c.violationWarningData,this._boundsData=c.boundsData,[4,a.getProduct()];case 3:return u=r.sent(),this._surfaceCount=u.surfaces.length,this.emitChange({urls:this.hiResUrls,proofs:this.proofImageUrls,stateId:this.stateId,userId:this.userId,userChanges:this.userChanges,violationWarningData:this.violationWarningData,boundsData:this.boundsData},!0),[2,c.hiResOutputUrls]}})})},t.prototype.getVariableData=function(){return Object(r.b)(this,void 0,void 0,function(){var e,t;return Object(r.e)(this,function(n){switch(n.label){case 0:return[4,this.getProduct()];case 1:return e=n.sent(),t=this,[4,e.getVariableItems()];case 2:return t._variableData=n.sent().reverse(),this.emitChange({data:this.variableData}),[2,this.variableData]}})})},t.prototype.getAllItems=function(){return Object(r.b)(this,void 0,void 0,function(){var e;return Object(r.e)(this,function(t){switch(t.label){case 0:return[4,this.getProduct()];case 1:return[4,t.sent().getProductModel()];case 2:return e=t.sent(),this._allItems=e.getAllItems({ignoreMockups:!0,flatGroupItems:!0,excludeGroupItems:!0}).reverse(),this.emitChange(),[2,this.allItems]}})})},t.prototype.getDepositPhotos=function(){return Object(r.b)(this,void 0,void 0,function(){var e,t;return Object(r.e)(this,function(n){switch(n.label){case 0:return[4,this.getProduct()];case 1:return[4,n.sent().getProductModel()];case 2:return[4,n.sent().getAllItems({ignoreMockups:!0,flatGroupItems:!0,excludeGroupItems:!0})];case 3:return e=n.sent(),t=[],e.forEach(function(e){var n=e.tags.dp_data;if(Object(Z.a)(n)){var r=function(e){return e&&e.tags&&null!==e.tags.sourceData&&"DepositPhotosSource"===e.tags.sourceType},i=function(e){return e.tags.sourceData};if(r(e)){var s=i(e);t.push({imageId:e.id,depositPhotosId:s.id})}else if(e.content&&r(e.content)){var o=i(e.content);t.push({imageId:e.id,depositPhotosId:o.id})}}else t.push({imageId:e.id,depositPhotosId:JSON.parse(n).id})}),this._depositPhotos=t,this.emitChange({data:this.depositPhotos}),[2,t]}})})},t.prototype.getTags=function(){return Object(r.b)(this,void 0,void 0,function(){var e,t;return Object(r.e)(this,function(n){switch(n.label){case 0:return[4,this.getProduct()];case 1:return e=n.sent(),t=this,[4,e.getTags()];case 2:return t._tags=n.sent(),void 0===this._tags&&(this._tags={}),this.emitChange({tags:this.tags}),[2,this.tags]}})})},t.prototype.setTags=function(e){return Object(r.b)(this,void 0,void 0,function(){return Object(r.e)(this,function(t){switch(t.label){case 0:return[4,this.getProduct()];case 1:return[4,t.sent().setTags(e)];case 2:return t.sent(),this._tags=e,this.emitChange({tags:this.tags}),[2]}})})},t.prototype.saveProduct=function(e,t){return Object(r.b)(this,void 0,void 0,function(){var n,i,s;return Object(r.e)(this,function(r){switch(r.label){case 0:return[4,this.getEditor()];case 1:return[4,(n=r.sent()).saveProduct(e,t)];case 2:return i=r.sent(),this._stateId=i.stateId,this._userId=i.userId,[4,n.getProduct()];case 3:return s=r.sent(),this._surfaceCount=s.surfaces.length,this.emitChange({stateId:this.stateId,userId:this.userId},!0),[2,i]}})})},t.prototype.replaceInterpolationPlaceholder=function(){return Object(r.b)(this,void 0,void 0,function(){return Object(r.e)(this,function(e){switch(e.label){case 0:return this._currentParams.replaceInterpolationPlaceholders?[4,this.getEditor()]:[2,Promise.resolve()];case 1:return e.sent().replaceInterpolationPlaceholders(),[2]}})})},t.prototype.toggleMaximizeMainPanel=function(e){this.publishData({main:e},Y.a.TOGGLE_SIZE_MAIN)},t.prototype.openAssetManagerFor=function(e){return Object(r.b)(this,void 0,void 0,function(){return Object(r.e)(this,function(t){switch(t.label){case 0:return[4,this.getEditor()];case 1:return[4,t.sent().openGalleryForItem(e)];case 2:return t.sent(),[2]}})})},t.prototype.openGalleryForBackground=function(){return Object(r.b)(this,void 0,void 0,function(){return Object(r.e)(this,function(e){switch(e.label){case 0:return[4,this.getEditor()];case 1:return[4,e.sent().openGalleryForBackground()];case 2:return e.sent(),[2]}})})},t.prototype.getItemText=function(e){return Object(r.b)(this,void 0,void 0,function(){var t,n,i,s;return Object(r.e)(this,function(r){switch(r.label){case 0:return[4,this.getEditor()];case 1:return[4,r.sent().getProduct()];case 2:return[4,r.sent().getProductModel()];case 3:return t=r.sent(),n=t.getAllItems({ignoreMockups:!0,flatGroupItems:!0,excludeGroupItems:!0}),i=n.find(function(t){return t.name===e}),s=Object(z.k)(i&&i instanceof CustomersCanvas.DesignAtoms.ObjectModel.BaseTextItem?i.text:""),this.itemsData[e]=this.itemsData[e]||{},this.itemsData[e].text=s,this.emitChange(),[2,s]}})})},Object.defineProperty(t.prototype,"token",{get:function(){return this._token},enumerable:!1,configurable:!0}),t.prototype.getToken=function(){return Object(r.b)(this,void 0,void 0,function(){var e,t;return Object(r.e)(this,function(n){switch(n.label){case 0:return[4,this.getEditor()];case 1:e=n.sent(),t="",n.label=2;case 2:return n.trys.push([2,4,,5]),[4,e.eval("spEditor.configuration.tokenId;")];case 3:return t=n.sent(),[3,5];case 4:return n.sent(),console.error("Failed to get user token"),[3,5];case 5:return this._token=t,this.emitChange(),[2,t]}})})},t.prototype.getSurfaceCount=function(){return Object(r.b)(this,void 0,void 0,function(){var e,t;return Object(r.e)(this,function(n){switch(n.label){case 0:return[4,this.getProduct()];case 1:return e=n.sent(),t=e.surfaces.length,this._surfaceCount=t,this.emitChange(),[2,t]}})})},t.prototype.getPreloaderMessage=function(e,t){var n,r,i,s;return t?null!==(r=null===(n=null===e||void 0===e?void 0:e.preloader)||void 0===n?void 0:n.initialMessage)&&void 0!==r?r:this.localize("common.loading.preload"):null!==(s=null===(i=null===e||void 0===e?void 0:e.preloader)||void 0===i?void 0:i.actionsMessage)&&void 0!==s?s:this.localize("common.loading.preload")},t.prototype.switchItemContent=function(e){return Object(r.b)(this,void 0,void 0,function(){var t,n,i,s,o,a,c,u,l,d,h,f,p,g,m,b,v,w;return Object(r.e)(this,function(r){switch(r.label){case 0:return y.a.isNullOrUndefined(e.to)||y.a.isNullOrUndefined(e.from)?[2]:[4,this.getProduct()];case 1:return[4,(t=r.sent()).getProductModel()];case 2:if(n=r.sent(),s=(i=function(e){var t=n.surfaces.elementAt(e.surfaceIndex);return t?t.getAllItems({ignoreMockups:!0,flatGroupItems:!0,excludeGroupItems:!0}).firstOrDefault(function(t){return t.name===e.name}):null})(e.from),o=i(e.to),y.a.isNullOrUndefined(o)&&y.a.isNotNullOrUndefined(s)&&!0===e.to.force&&(o=s.clone(!0),(a=n.surfaces.elementAt(e.to.surfaceIndex))&&a.containers[_.a.MAIN_CONTAINER_NAME].items.add(o)),y.a.isNullOrUndefined(s)||y.a.isNullOrUndefined(o))return[2];if(s.type!==o.type)return console.warn("Items have not matching types"),[2];switch(!0){case s instanceof window.CustomersCanvas.DesignAtoms.ObjectModel.BaseTextItem:u=o,l=(c=s).text,d=u.text,c.text=d,u.text=l;break;case s instanceof window.CustomersCanvas.DesignAtoms.ObjectModel.PlaceholderItem:f=o,p=(h=s).content.source,g=f.content.source,h.content.source=g,f.content.source=p;break;case s instanceof window.CustomersCanvas.DesignAtoms.ObjectModel.ImageItem:b=o,v=(m=s).source,w=b.source,m.source=w,b.source=v}return[4,t.setProductModel(n)];case 3:return r.sent(),[2]}})})},t=Object(r.c)([Object(X.a)("au-widget-design-editor",i)],t)}(w)}}]);