(window.multistep_editor_jsonpFunction=window.multistep_editor_jsonpFunction||[]).push([[41],{916:function(t,e){t.exports='<style>\n    :host {\n        width: 100%;\n        height: 100%;\n    }\n</style>\n\n<iframe id="frameID" width="100%" height="100%" style="border: none;"></iframe>\n\n'},946:function(t,e,i){"use strict";i.r(e),i.d(e,"AuWidgetTemplateEditor",function(){return d}),i.d(e,"widget",function(){return d});var s=i(0),a=i(172),n=i(1),o=i(916),r=i(6);let d=class extends a.c{constructor(){super(),this._eventsInited=!1,this.script="",this.styles="",this._iframeLoaded=!1,this._initIFrame=this._initIFrame.bind(this),this._loadResources()}async _loadResources(){const t=Date.now(),e=`${r.a.getPatchedUrl("static/template-editor/script.html")}?t=${t}`,i=`${r.a.getPatchedUrl("static/template-editor/style.html")}?t=${t}`,[s,a]=await Promise.all([r.a.loadHtml(e),r.a.loadHtml(i)]);this.script=s.replace("TextWhizzJS.wasm",`${r.a.getPatchedUrl("static/data-driven-editor/TextWhizzJS.wasm")}`),this.styles=a,await this._initIFrame()}updateParams(t,e){}async updateParamsAsync(t,e){super.updateParamsAsync(t,e);const i=await this._itemPromise();await this._initSubscribers(this._element),i.configuration=Object.assign({language:this.language},t.config),t.stateId?await this.setStateId(t.stateId):t.product?await this.setProduct(t.product):console.warn("stateId or product missing.")}async getProduct(){return this._element.getProductJson()}async setProduct(t){this._element.setProductJson(t)}async setStateId(t){await this._element.setStateId(t)}async setToken(t){this._element.setToken(t)}async saveProduct(){await this._element.saveProduct()}_iframeLoadedPromise(){return new Promise((t,e)=>{!0===this._iframeLoaded?t():this._iframeDoc.addEventListener("DOMContentLoaded",()=>{this._iframeLoaded=!0,t()})})}_itemPromise(){return new Promise((t,e)=>{if(this._element)t(this._element);else{const e=()=>{setTimeout(async()=>{if(this._iframeDoc){const e=this._iframeDoc.querySelector("au-template-editor");e&&(this._element=e,window.Aurigma=Object.assign(window.Aurigma,this._iframeWin.contentWindow.Aurigma),t(e))}this._element||e()},200)};e()}})}_itemInitedPromise(){return new Promise(async(t,e)=>{const i=await this._itemPromise();i.isInited&&t(i),i.addEventListener("inited",e=>{t(i)})})}async _initSubscribers(t){this._eventsInited||(this._eventsInited=!0,this.$productSaved=t.$productSaved(),await this._getLocales(t))}async _getLocales(t){let e=await r.a.loadJson("static/template-editor/locales.json?t="+Date.now());for(const i of Object.keys(e))t.addLocalization(i,e[i]);t.setLanguage(this.language)}async _initIFrame(){const t=this.querySelectorShadow("#frameID"),e=t||t.contentWindow,i=t.contentDocument||e.document;i.write('<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500&display=swap" rel="stylesheet" />'),i.write('<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />'),i.write(this.script),i.write(this.styles),i.write("<style> .mat-button-toggle-button { height: 100%; } </style>"),i.write('<div style="width:100%;height:100%"><au-template-editor id="templateeditor"></au-template-editor> </div>'),this._iframeDoc=i,this._iframeWin=e}};d=Object(s.b)([Object(n.a)("au-widget-template-editor",o),Object(s.d)("design:paramtypes",[])],d)}}]);