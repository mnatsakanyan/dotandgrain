(window.multistep_editor_jsonpFunction=window.multistep_editor_jsonpFunction||[]).push([[22],{738:function(n,e){},873:function(n,e){n.exports='<style>\n    #body {\n        height: 100%;\n        width: 100%;\n        display: flex;\n        flex-direction: column;\n        overflow-y: auto;\n    }\n\n    #table {\n        width: 100%;\n        height: 100%;\n        overflow-y: auto;\n        flex: 1 1 auto;\n    }\n\n    /* A style of the current row. */\n    /* .highlight {\n        background-color: var(--theme-primary-color) !important;\n    } */\n\n    .wtBorder.current {\n        background-color: var(--theme-primary-color) !important;\n    }\n\n    .ht_master.handsontable {\n        padding-bottom: 20px;\n    }\n\n    .buttons-parent {\n        width: 100%;\n        flex: 0 0 10px;\n        padding-bottom: 10px;\n    }\n\n    paper-button {\n        background-color: var(--theme-interface-color);\n        color: var(--theme-enabled-button-color);\n        @apply --au-header-button-geometry;\n        @apply --paper-font-title;\n        line-height: calc(1.125 * var(--au-hem));\n        font-size: calc(0.875 * var(--au-hem));\n        font-weight: 500;\n        text-align: center;\n        text-transform: none;\n        margin: 0;\n    }\n\n    .buttons-body-left {\n        float: left;\n    }\n\n    .buttons-body-left paper-button {\n        border: 1px solid var(--theme-enabled-button-border-color);\n    }\n\n    .buttons-body-left:first-child {\n        margin-left: 0px !important;\n    }\n\n    .buttons-body-right {\n        float: right;\n    }\n\n    .buttons-body-right:first-child {\n        padding-right: 0px;\n    }\n\n    .buttons-body-right:last-child {\n        margin-right: 0px\n    }\n\n    .hidden {\n        display: none !important;\n    }\n\n    .table-messages {\n        height: 100%;\n        width: 100%;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n\n    .ht_master .wtHolder {\n        overflow: visible !important;\n    }\n\n    .ht_clone_left.handsontable {\n        overflow: visible !important;\n    }\n\n    .ht_master.handsontable {\n        overflow: visible !important;\n    }\n\n    .ht_clone_left .wtHolder {\n        overflow: visible !important;\n    }\n\n    .ht_master.handsontable {\n        padding-bottom: 0px !important;\n    }\n</style>\n<div id="body">\n    <div class="buttons-parent">\n        <div class="buttons-body-left" id="buttonsLeft">\n            <input type="file" style="display:none;" on-change="changeFile" id="openFile" />\n            <paper-button on-tap="downloadXSLTFile">{{ localize(\'widgets.datasheet.data.export\') }}</paper-button>\n            <paper-button on-tap="openFileDialog">{{ localize(\'widgets.datasheet.data.import\') }}</paper-button>\n        </div>\n        <div class="buttons-body-right" id="buttonsRight">\n            <paper-button on-tap="addRow" disabled$="[[!tableService.isTableCreated]]">\n                {{localize(\'widgets.datasheet.row.add\')}}\n            </paper-button>\n            <paper-button on-tap="deleteRow" disabled$="[[!tableService.isTableCreated]]">\n                {{localize(\'widgets.datasheet.row.delete\')}}\n            </paper-button>\n        </div>\n    </div>\n\n    \x3c!-- Table --\x3e\n    <div id="table" style$="[[_tableStyle(tableService.isTableCreated)]]"></div>\n\n    \x3c!-- Messages --\x3e\n    <template is="dom-if" if="[[_showTableMessages(tableService.isTableCreated, tableService.isTableEmpty)]]">\n        <div class="table-messages">\n            \x3c!-- Table not created text --\x3e\n            <template is="dom-if" if="[[!tableService.isTableCreated]]">\n                <iron-label class="flex-3">\n                    {{ localize(\'widgets.datasheet.messages.tableNotCreated\') }}\n                </iron-label>\n            </template>\n\n            \x3c!-- Table empty text --\x3e\n            <template is="dom-if" if="[[tableService.isTableEmpty]]">\n                <iron-label class="flex-3">\n                    {{ localize(\'widgets.datasheet.messages.tableIsEmpty\') }}\n                </iron-label>\n            </template>\n        </div>\n    </template>\n</div>'},874:function(n,e){n.exports='<style>\n    .handsontable .table td,\n    .handsontable .table th {\n        border-top: none\n    }\n\n    .handsontable tr {\n        background: #fff\n    }\n\n    .handsontable td {\n        background-color: inherit\n    }\n\n    .handsontable .table caption+thead tr:first-child td,\n    .handsontable .table caption+thead tr:first-child th,\n    .handsontable .table colgroup+thead tr:first-child td,\n    .handsontable .table colgroup+thead tr:first-child th,\n    .handsontable .table thead:first-child tr:first-child td,\n    .handsontable .table thead:first-child tr:first-child th {\n        border-top: 1px solid #ccc\n    }\n\n    .handsontable .table-bordered {\n        border: 0;\n        border-collapse: separate\n    }\n\n    .handsontable .table-bordered td,\n    .handsontable .table-bordered th {\n        border-left: none\n    }\n\n    .handsontable .table-bordered td:first-child,\n    .handsontable .table-bordered th:first-child {\n        border-left: 1px solid #ccc\n    }\n\n    .handsontable .table>tbody>tr>td,\n    .handsontable .table>tbody>tr>th,\n    .handsontable .table>tfoot>tr>td,\n    .handsontable .table>tfoot>tr>th,\n    .handsontable .table>thead>tr>td,\n    .handsontable .table>thead>tr>th {\n        line-height: 21px;\n        padding: 0 4px\n    }\n\n    .col-lg-1.handsontable,\n    .col-lg-2.handsontable,\n    .col-lg-3.handsontable,\n    .col-lg-4.handsontable,\n    .col-lg-5.handsontable,\n    .col-lg-6.handsontable,\n    .col-lg-7.handsontable,\n    .col-lg-8.handsontable,\n    .col-lg-9.handsontable,\n    .col-lg-10.handsontable,\n    .col-lg-11.handsontable,\n    .col-lg-12.handsontable,\n    .col-md-1.handsontable,\n    .col-md-2.handsontable,\n    .col-md-3.handsontable,\n    .col-md-4.handsontable,\n    .col-md-5.handsontable,\n    .col-md-6.handsontable,\n    .col-md-7.handsontable,\n    .col-md-8.handsontable,\n    .col-md-9.handsontable .col-sm-1.handsontable,\n    .col-md-10.handsontable,\n    .col-md-11.handsontable,\n    .col-md-12.handsontable,\n    .col-sm-2.handsontable,\n    .col-sm-3.handsontable,\n    .col-sm-4.handsontable,\n    .col-sm-5.handsontable,\n    .col-sm-6.handsontable,\n    .col-sm-7.handsontable,\n    .col-sm-8.handsontable,\n    .col-sm-9.handsontable .col-xs-1.handsontable,\n    .col-sm-10.handsontable,\n    .col-sm-11.handsontable,\n    .col-sm-12.handsontable,\n    .col-xs-2.handsontable,\n    .col-xs-3.handsontable,\n    .col-xs-4.handsontable,\n    .col-xs-5.handsontable,\n    .col-xs-6.handsontable,\n    .col-xs-7.handsontable,\n    .col-xs-8.handsontable,\n    .col-xs-9.handsontable,\n    .col-xs-10.handsontable,\n    .col-xs-11.handsontable,\n    .col-xs-12.handsontable {\n        padding-left: 0;\n        padding-right: 0\n    }\n\n    .handsontable .table-striped>tbody>tr:nth-of-type(2n) {\n        background-color: #fff\n    }\n\n    .handsontable {\n        position: relative\n    }\n\n    .handsontable .hide {\n        display: none\n    }\n\n    .handsontable .relative {\n        position: relative\n    }\n\n    .handsontable.htAutoSize {\n        visibility: hidden;\n        left: -99000px;\n        position: absolute;\n        top: -99000px\n    }\n\n    .handsontable .wtHider {\n        width: 0\n    }\n\n    .handsontable .wtSpreader {\n        position: relative;\n        width: 0;\n        height: auto\n    }\n\n    .handsontable div,\n    .handsontable input,\n    .handsontable table,\n    .handsontable tbody,\n    .handsontable td,\n    .handsontable textarea,\n    .handsontable th,\n    .handsontable thead {\n        box-sizing: content-box;\n        -webkit-box-sizing: content-box;\n        -moz-box-sizing: content-box\n    }\n\n    .handsontable input,\n    .handsontable textarea {\n        min-height: 0\n    }\n\n    .handsontable table.htCore {\n        border-collapse: separate;\n        border-spacing: 0;\n        margin: 0;\n        border-width: 0;\n        table-layout: fixed;\n        width: 0;\n        outline-width: 0;\n        cursor: default;\n        max-width: none;\n        max-height: none\n    }\n\n    .handsontable col,\n    .handsontable col.rowHeader {\n        width: 50px\n    }\n\n    .handsontable td,\n    .handsontable th {\n        border-top-width: 0;\n        border-left-width: 0;\n        border-right: 1px solid #ccc;\n        border-bottom: 1px solid #ccc;\n        height: 22px;\n        empty-cells: show;\n        line-height: 21px;\n        padding: 0 4px;\n        background-color: #fff;\n        vertical-align: top;\n        overflow: hidden;\n        outline-width: 0;\n        white-space: pre-line;\n        background-clip: padding-box\n    }\n\n    .handsontable td.htInvalid {\n        background-color: #ff4c42 !important\n    }\n\n    .handsontable td.htNoWrap {\n        white-space: nowrap\n    }\n\n    .handsontable th:last-child {\n        border-right: 1px solid #ccc;\n        border-bottom: 1px solid #ccc\n    }\n\n    .handsontable th.htNoFrame,\n    .handsontable th:first-child.htNoFrame,\n    .handsontable tr:first-child th.htNoFrame {\n        border-left-width: 0;\n        background-color: #fff;\n        border-color: #fff\n    }\n\n    .handsontable .htNoFrame+td,\n    .handsontable .htNoFrame+th,\n    .handsontable.htRowHeaders thead tr th:nth-child(2),\n    .handsontable td:first-of-type,\n    .handsontable th:first-child,\n    .handsontable th:nth-child(2) {\n        border-left: 1px solid #ccc\n    }\n\n    .handsontable tr:first-child td,\n    .handsontable tr:first-child th {\n        border-top: 1px solid #ccc\n    }\n\n    .ht_master:not(.innerBorderLeft):not(.emptyColumns)~.handsontable:not(.ht_clone_top) thead tr th:first-child,\n    .ht_master:not(.innerBorderLeft):not(.emptyColumns)~.handsontable tbody tr th {\n        border-right-width: 0\n    }\n\n    .ht_master:not(.innerBorderTop) thead tr.lastChild th,\n    .ht_master:not(.innerBorderTop) thead tr:last-child th,\n    .ht_master:not(.innerBorderTop)~.handsontable thead tr.lastChild th,\n    .ht_master:not(.innerBorderTop)~.handsontable thead tr:last-child th {\n        border-bottom-width: 0\n    }\n\n    .handsontable th {\n        background-color: #f0f0f0;\n        color: #222;\n        text-align: center;\n        font-weight: 400;\n        white-space: nowrap\n    }\n\n    .handsontable thead th {\n        padding: 0\n    }\n\n    .handsontable th.active {\n        background-color: #ccc\n    }\n\n    .handsontable thead th .relative {\n        padding: 2px 4px\n    }\n\n    #hot-display-license-info {\n        font-size: 10px;\n        color: #323232;\n        padding: 5px 0 3px;\n        font-family: Helvetica, Arial, sans-serif;\n        text-align: left\n    }\n\n    .handsontable .manualColumnResizer {\n        position: fixed;\n        top: 0;\n        cursor: col-resize;\n        z-index: 110;\n        width: 5px;\n        height: 25px\n    }\n\n    .handsontable .manualRowResizer {\n        position: fixed;\n        left: 0;\n        cursor: row-resize;\n        z-index: 110;\n        height: 5px;\n        width: 50px\n    }\n\n    .handsontable .manualColumnResizer.active,\n    .handsontable .manualColumnResizer:hover,\n    .handsontable .manualRowResizer.active,\n    .handsontable .manualRowResizer:hover {\n        background-color: #34a9db\n    }\n\n    .handsontable .manualColumnResizerGuide {\n        position: fixed;\n        right: 0;\n        top: 0;\n        background-color: #34a9db;\n        display: none;\n        width: 0;\n        border-right: 1px dashed #777;\n        margin-left: 5px\n    }\n\n    .handsontable .manualRowResizerGuide {\n        position: fixed;\n        left: 0;\n        bottom: 0;\n        background-color: #34a9db;\n        display: none;\n        height: 0;\n        border-bottom: 1px dashed #777;\n        margin-top: 5px\n    }\n\n    .handsontable .manualColumnResizerGuide.active,\n    .handsontable .manualRowResizerGuide.active {\n        display: block;\n        z-index: 199\n    }\n\n    .handsontable .columnSorting {\n        position: relative\n    }\n\n    .handsontable .columnSorting:hover {\n        text-decoration: underline;\n        cursor: pointer\n    }\n\n    .handsontable .columnSorting.ascending:after {\n        content: "\\25B2";\n        color: #5f5f5f;\n        position: absolute;\n        right: -15px\n    }\n\n    .handsontable .columnSorting.descending:after {\n        content: "\\25BC";\n        color: #5f5f5f;\n        position: absolute;\n        right: -15px\n    }\n\n    .handsontable .wtBorder {\n        position: absolute;\n        font-size: 0\n    }\n\n    .handsontable .wtBorder.hidden {\n        display: none !important\n    }\n\n    .handsontable .wtBorder.current {\n        z-index: 10\n    }\n\n    .handsontable .wtBorder.area {\n        z-index: 8\n    }\n\n    .handsontable .wtBorder.fill {\n        z-index: 6\n    }\n\n    .handsontable td.area,\n    .handsontable td.area-1,\n    .handsontable td.area-2,\n    .handsontable td.area-3,\n    .handsontable td.area-4,\n    .handsontable td.area-5,\n    .handsontable td.area-6,\n    .handsontable td.area-7 {\n        position: relative\n    }\n\n    .handsontable td.area-1:before,\n    .handsontable td.area-2:before,\n    .handsontable td.area-3:before,\n    .handsontable td.area-4:before,\n    .handsontable td.area-5:before,\n    .handsontable td.area-6:before,\n    .handsontable td.area-7:before,\n    .handsontable td.area:before {\n        content: "";\n        position: absolute;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        bottom: -100%\\9;\n        background: #005eff\n    }\n\n    @media (-ms-high-contrast:none),\n    screen and (-ms-high-contrast:active) {\n\n        .handsontable td.area-1:before,\n        .handsontable td.area-2:before,\n        .handsontable td.area-3:before,\n        .handsontable td.area-4:before,\n        .handsontable td.area-5:before,\n        .handsontable td.area-6:before,\n        .handsontable td.area-7:before,\n        .handsontable td.area:before {\n            bottom: -100%\n        }\n    }\n\n    .handsontable td.area:before {\n        opacity: .1\n    }\n\n    .handsontable td.area-1:before {\n        opacity: .2\n    }\n\n    .handsontable td.area-2:before {\n        opacity: .27\n    }\n\n    .handsontable td.area-3:before {\n        opacity: .35\n    }\n\n    .handsontable td.area-4:before {\n        opacity: .41\n    }\n\n    .handsontable td.area-5:before {\n        opacity: .47\n    }\n\n    .handsontable td.area-6:before {\n        opacity: .54\n    }\n\n    .handsontable td.area-7:before {\n        opacity: .58\n    }\n\n    .handsontable tbody th.ht__highlight,\n    .handsontable thead th.ht__highlight {\n        background-color: #dcdcdc\n    }\n\n    .handsontable tbody th.ht__active_highlight,\n    .handsontable thead th.ht__active_highlight {\n        background-color: #8eb0e7;\n        color: #000\n    }\n\n    .handsontable .wtBorder.corner {\n        font-size: 0;\n        cursor: crosshair\n    }\n\n    .handsontable .htBorder.htFillBorder {\n        background: red;\n        width: 1px;\n        height: 1px\n    }\n\n    .handsontableInput {\n        border: none;\n        outline-width: 0;\n        margin: 0;\n        padding: 1px 5px 0;\n        font-family: inherit;\n        line-height: 21px;\n        font-size: inherit;\n        box-shadow: inset 0 0 0 2px #5292f7;\n        resize: none;\n        display: block;\n        color: #000;\n        border-radius: 0;\n        background-color: #fff\n    }\n\n    .handsontableInputHolder {\n        position: absolute;\n        top: 0;\n        left: 0;\n        z-index: 104\n    }\n\n    .htSelectEditor {\n        -webkit-appearance: menulist-button !important;\n        position: absolute;\n        width: auto\n    }\n\n    .handsontable .htDimmed {\n        color: #777\n    }\n\n    .handsontable .htSubmenu {\n        position: relative\n    }\n\n    .handsontable .htSubmenu :after {\n        content: "\\25B6";\n        color: #777;\n        position: absolute;\n        right: 5px;\n        font-size: 9px\n    }\n\n    .handsontable .htLeft {\n        text-align: left\n    }\n\n    .handsontable .htCenter {\n        text-align: center\n    }\n\n    .handsontable .htRight {\n        text-align: right\n    }\n\n    .handsontable .htJustify {\n        text-align: justify\n    }\n\n    .handsontable .htTop {\n        vertical-align: top\n    }\n\n    .handsontable .htMiddle {\n        vertical-align: middle\n    }\n\n    .handsontable .htBottom {\n        vertical-align: bottom\n    }\n\n    .handsontable .htPlaceholder {\n        color: #999\n    }\n\n    .handsontable .htAutocompleteArrow {\n        float: right;\n        font-size: 10px;\n        color: #eee;\n        cursor: default;\n        width: 16px;\n        text-align: center\n    }\n\n    .handsontable td .htAutocompleteArrow:hover {\n        color: #777\n    }\n\n    .handsontable td.area .htAutocompleteArrow {\n        color: #d3d3d3\n    }\n\n    .handsontable .htCheckboxRendererInput {\n        display: inline-block;\n        vertical-align: middle\n    }\n\n    .handsontable .htCheckboxRendererInput.noValue {\n        opacity: .5\n    }\n\n    .handsontable .htCheckboxRendererLabel {\n        cursor: pointer;\n        display: inline-block;\n        width: 100%\n    }\n\n    .handsontable .handsontable.ht_clone_top .wtHider {\n        padding: 0 0 5px\n    }\n\n    .handsontable .autocompleteEditor.handsontable {\n        padding-right: 17px\n    }\n\n    .handsontable .autocompleteEditor.handsontable.htMacScroll {\n        padding-right: 15px\n    }\n\n    .handsontable.listbox {\n        margin: 0\n    }\n\n    .handsontable.listbox .ht_master table {\n        border: 1px solid #ccc;\n        border-collapse: separate;\n        background: #fff\n    }\n\n    .handsontable.listbox td,\n    .handsontable.listbox th,\n    .handsontable.listbox tr:first-child td,\n    .handsontable.listbox tr:first-child th,\n    .handsontable.listbox tr:last-child th {\n        border-color: transparent\n    }\n\n    .handsontable.listbox td,\n    .handsontable.listbox th {\n        white-space: nowrap;\n        text-overflow: ellipsis\n    }\n\n    .handsontable.listbox td.htDimmed {\n        cursor: default;\n        color: inherit;\n        font-style: inherit\n    }\n\n    .handsontable.listbox .wtBorder {\n        visibility: hidden\n    }\n\n    .handsontable.listbox tr:hover td,\n    .handsontable.listbox tr td.current {\n        background: #eee\n    }\n\n    .ht_clone_top {\n        z-index: 101\n    }\n\n    .ht_clone_left {\n        z-index: 102\n    }\n\n    .ht_clone_bottom_left_corner,\n    .ht_clone_debug,\n    .ht_clone_top_left_corner {\n        z-index: 103\n    }\n\n    .handsontable td.htSearchResult {\n        background: #fcedd9;\n        color: #583707\n    }\n\n    .htBordered {\n        border-width: 1px\n    }\n\n    .htBordered.htTopBorderSolid {\n        border-top-style: solid;\n        border-top-color: #000\n    }\n\n    .htBordered.htRightBorderSolid {\n        border-right-style: solid;\n        border-right-color: #000\n    }\n\n    .htBordered.htBottomBorderSolid {\n        border-bottom-style: solid;\n        border-bottom-color: #000\n    }\n\n    .htBordered.htLeftBorderSolid {\n        border-left-style: solid;\n        border-left-color: #000\n    }\n\n    .handsontable tbody tr th:nth-last-child(2) {\n        border-right: 1px solid #ccc\n    }\n\n    .handsontable thead tr:nth-last-child(2) th.htGroupIndicatorContainer {\n        border-bottom: 1px solid #ccc;\n        padding-bottom: 5px\n    }\n\n    .ht_clone_top_left_corner thead tr th:nth-last-child(2) {\n        border-right: 1px solid #ccc\n    }\n\n    .htCollapseButton {\n        width: 10px;\n        height: 10px;\n        line-height: 10px;\n        text-align: center;\n        border-radius: 5px;\n        border: 1px solid #f3f3f3;\n        box-shadow: 1px 1px 3px rgba(0, 0, 0, .4);\n        cursor: pointer;\n        margin-bottom: 3px;\n        position: relative\n    }\n\n    .htCollapseButton:after {\n        content: "";\n        height: 300%;\n        width: 1px;\n        display: block;\n        background: #ccc;\n        margin-left: 4px;\n        position: absolute;\n        bottom: 10px\n    }\n\n    thead .htCollapseButton {\n        right: 5px;\n        position: absolute;\n        top: 5px;\n        background: #fff\n    }\n\n    thead .htCollapseButton:after {\n        height: 1px;\n        width: 700%;\n        right: 10px;\n        top: 4px\n    }\n\n    .handsontable tr th .htExpandButton {\n        position: absolute;\n        width: 10px;\n        height: 10px;\n        line-height: 10px;\n        text-align: center;\n        border-radius: 5px;\n        border: 1px solid #f3f3f3;\n        box-shadow: 1px 1px 3px rgba(0, 0, 0, .4);\n        cursor: pointer;\n        top: 0;\n        display: none\n    }\n\n    .handsontable thead tr th .htExpandButton {\n        top: 5px\n    }\n\n    .handsontable tr th .htExpandButton.clickable {\n        display: block\n    }\n\n    .collapsibleIndicator {\n        position: absolute;\n        top: 50%;\n        transform: translateY(-50%);\n        right: 5px;\n        border: 1px solid #a6a6a6;\n        line-height: 10px;\n        color: #222;\n        border-radius: 10px;\n        font-size: 10px;\n        width: 10px;\n        height: 10px;\n        cursor: pointer;\n        box-shadow: 0 0 0 6px #eee;\n        background: #eee\n    }\n\n    .handsontable col.hidden {\n        width: 0 !important\n    }\n\n    .handsontable table tr th.lightRightBorder {\n        border-right: 1px solid #e6e6e6\n    }\n\n    .handsontable tr.hidden,\n    .handsontable tr.hidden td,\n    .handsontable tr.hidden th {\n        display: none\n    }\n\n    .ht_clone_bottom,\n    .ht_clone_left,\n    .ht_clone_top,\n    .ht_master {\n        overflow: hidden\n    }\n\n    .ht_master .wtHolder {\n        overflow: auto\n    }\n\n    .handsontable .ht_clone_left thead,\n    .handsontable .ht_master thead,\n    .handsontable .ht_master tr th {\n        visibility: hidden\n    }\n\n    .ht_clone_bottom .wtHolder,\n    .ht_clone_left .wtHolder,\n    .ht_clone_top .wtHolder {\n        overflow: hidden\n    }\n\n    .handsontable.mobile,\n    .handsontable.mobile .wtHolder {\n        -webkit-touch-callout: none;\n        -webkit-user-select: none;\n        -moz-user-select: none;\n        -ms-user-select: none;\n        user-select: none;\n        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n        -webkit-overflow-scrolling: touch\n    }\n\n    .htMobileEditorContainer {\n        display: none;\n        position: absolute;\n        top: 0;\n        width: 70%;\n        height: 54pt;\n        background: #f8f8f8;\n        border-radius: 20px;\n        border: 1px solid #ebebeb;\n        z-index: 999;\n        box-sizing: border-box;\n        -webkit-box-sizing: border-box;\n        -webkit-text-size-adjust: none\n    }\n\n    .topLeftSelectionHandle-HitArea:not(.ht_master .topLeftSelectionHandle-HitArea),\n    .topLeftSelectionHandle:not(.ht_master .topLeftSelectionHandle) {\n        z-index: 9999\n    }\n\n    .bottomRightSelectionHandle,\n    .bottomRightSelectionHandle-HitArea,\n    .topLeftSelectionHandle,\n    .topLeftSelectionHandle-HitArea {\n        left: -10000px;\n        top: -10000px\n    }\n\n    .htMobileEditorContainer.active {\n        display: block\n    }\n\n    .htMobileEditorContainer .inputs {\n        position: absolute;\n        right: 210pt;\n        bottom: 10pt;\n        top: 10pt;\n        left: 14px;\n        height: 34pt\n    }\n\n    .htMobileEditorContainer .inputs textarea {\n        font-size: 13pt;\n        border: 1px solid #a1a1a1;\n        -webkit-appearance: none;\n        box-shadow: none;\n        position: absolute;\n        left: 14px;\n        right: 14px;\n        top: 0;\n        bottom: 0;\n        padding: 7pt\n    }\n\n    .htMobileEditorContainer .cellPointer {\n        position: absolute;\n        top: -13pt;\n        height: 0;\n        width: 0;\n        left: 30px;\n        border-left: 13pt solid transparent;\n        border-right: 13pt solid transparent;\n        border-bottom: 13pt solid #ebebeb\n    }\n\n    .htMobileEditorContainer .cellPointer.hidden {\n        display: none\n    }\n\n    .htMobileEditorContainer .cellPointer:before {\n        content: "";\n        display: block;\n        position: absolute;\n        top: 2px;\n        height: 0;\n        width: 0;\n        left: -13pt;\n        border-left: 13pt solid transparent;\n        border-right: 13pt solid transparent;\n        border-bottom: 13pt solid #f8f8f8\n    }\n\n    .htMobileEditorContainer .moveHandle {\n        position: absolute;\n        top: 10pt;\n        left: 5px;\n        width: 30px;\n        bottom: 0;\n        cursor: move;\n        z-index: 9999\n    }\n\n    .htMobileEditorContainer .moveHandle:after {\n        content: "..\\A..\\A..\\A..";\n        white-space: pre;\n        line-height: 10px;\n        font-size: 20pt;\n        display: inline-block;\n        margin-top: -8px;\n        color: #ebebeb\n    }\n\n    .htMobileEditorContainer .positionControls {\n        width: 205pt;\n        position: absolute;\n        right: 5pt;\n        top: 0;\n        bottom: 0\n    }\n\n    .htMobileEditorContainer .positionControls>div {\n        width: 50pt;\n        height: 100%;\n        float: left\n    }\n\n    .htMobileEditorContainer .positionControls>div:after {\n        content: " ";\n        display: block;\n        width: 15pt;\n        height: 15pt;\n        text-align: center;\n        line-height: 50pt\n    }\n\n    .htMobileEditorContainer .downButton:after,\n    .htMobileEditorContainer .leftButton:after,\n    .htMobileEditorContainer .rightButton:after,\n    .htMobileEditorContainer .upButton:after {\n        transform-origin: 5pt 5pt;\n        -webkit-transform-origin: 5pt 5pt;\n        margin: 21pt 0 0 21pt\n    }\n\n    .htMobileEditorContainer .leftButton:after {\n        border-top: 2px solid #288ffe;\n        border-left: 2px solid #288ffe;\n        -webkit-transform: rotate(-45deg)\n    }\n\n    .htMobileEditorContainer .leftButton:active:after {\n        border-color: #cfcfcf\n    }\n\n    .htMobileEditorContainer .rightButton:after {\n        border-top: 2px solid #288ffe;\n        border-left: 2px solid #288ffe;\n        -webkit-transform: rotate(135deg)\n    }\n\n    .htMobileEditorContainer .rightButton:active:after {\n        border-color: #cfcfcf\n    }\n\n    .htMobileEditorContainer .upButton:after {\n        border-top: 2px solid #288ffe;\n        border-left: 2px solid #288ffe;\n        -webkit-transform: rotate(45deg)\n    }\n\n    .htMobileEditorContainer .upButton:active:after {\n        border-color: #cfcfcf\n    }\n\n    .htMobileEditorContainer .downButton:after {\n        border-top: 2px solid #288ffe;\n        border-left: 2px solid #288ffe;\n        -webkit-transform: rotate(225deg)\n    }\n\n    .htMobileEditorContainer .downButton:active:after {\n        border-color: #cfcfcf\n    }\n\n    .handsontable.hide-tween {\n        animation: opacity-hide .3s;\n        animation-fill-mode: forwards;\n        -webkit-animation-fill-mode: forwards\n    }\n\n    .handsontable.show-tween {\n        animation: opacity-show .3s;\n        animation-fill-mode: forwards;\n        -webkit-animation-fill-mode: forwards\n    }\n\n    /*!\n * Pikaday\n * Copyright © 2014 David Bushell | BSD & MIT license | http://dbushell.com/\n */\n\n    .pika-single {\n        z-index: 9999;\n        display: block;\n        position: relative;\n        color: #333;\n        background: #fff;\n        border: 1px solid #ccc;\n        border-bottom-color: #bbb;\n        font-family: Helvetica Neue, Helvetica, Arial, sans-serif\n    }\n\n    .pika-single:after,\n    .pika-single:before {\n        content: " ";\n        display: table\n    }\n\n    .pika-single:after {\n        clear: both\n    }\n\n    .pika-single {\n        *zoom: 1\n    }\n\n    .pika-single.is-hidden {\n        display: none\n    }\n\n    .pika-single.is-bound {\n        position: absolute;\n        box-shadow: 0 5px 15px -5px rgba(0, 0, 0, .5)\n    }\n\n    .pika-lendar {\n        float: left;\n        width: 240px;\n        margin: 8px\n    }\n\n    .pika-title {\n        position: relative;\n        text-align: center\n    }\n\n    .pika-label {\n        display: inline-block;\n        *display: inline;\n        position: relative;\n        z-index: 9999;\n        overflow: hidden;\n        margin: 0;\n        padding: 5px 3px;\n        font-size: 14px;\n        line-height: 20px;\n        font-weight: 700;\n        background-color: #fff\n    }\n\n    .pika-title select {\n        cursor: pointer;\n        position: absolute;\n        z-index: 9998;\n        margin: 0;\n        left: 0;\n        top: 5px;\n        filter: alpha(opacity=0);\n        opacity: 0\n    }\n\n    .pika-next,\n    .pika-prev {\n        display: block;\n        cursor: pointer;\n        position: relative;\n        outline: none;\n        border: 0;\n        padding: 0;\n        width: 20px;\n        height: 30px;\n        text-indent: 20px;\n        white-space: nowrap;\n        overflow: hidden;\n        background-color: transparent;\n        background-position: 50%;\n        background-repeat: no-repeat;\n        background-size: 75% 75%;\n        opacity: .5;\n        *position: absolute;\n        *top: 0\n    }\n\n    .pika-next:hover,\n    .pika-prev:hover {\n        opacity: 1\n    }\n\n    .is-rtl .pika-next,\n    .pika-prev {\n        float: left;\n        background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAUklEQVR42u3VMQoAIBADQf8Pgj+OD9hG2CtONJB2ymQkKe0HbwAP0xucDiQWARITIDEBEnMgMQ8S8+AqBIl6kKgHiXqQqAeJepBo/z38J/U0uAHlaBkBl9I4GwAAAABJRU5ErkJggg==");\n        *left: 0\n    }\n\n    .is-rtl .pika-prev,\n    .pika-next {\n        float: right;\n        background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAU0lEQVR42u3VOwoAMAgE0dwfAnNjU26bYkBCFGwfiL9VVWoO+BJ4Gf3gtsEKKoFBNTCoCAYVwaAiGNQGMUHMkjGbgjk2mIONuXo0nC8XnCf1JXgArVIZAQh5TKYAAAAASUVORK5CYII=");\n        *right: 0\n    }\n\n    .pika-next.is-disabled,\n    .pika-prev.is-disabled {\n        cursor: default;\n        opacity: .2\n    }\n\n    .pika-select {\n        display: inline-block;\n        *display: inline\n    }\n\n    .pika-table {\n        width: 100%;\n        border-collapse: collapse;\n        border-spacing: 0;\n        border: 0\n    }\n\n    .pika-table td,\n    .pika-table th {\n        width: 14.285714285714286%;\n        padding: 0\n    }\n\n    .pika-table th {\n        color: #999;\n        font-size: 12px;\n        line-height: 25px;\n        font-weight: 700;\n        text-align: center\n    }\n\n    .pika-button {\n        cursor: pointer;\n        display: block;\n        box-sizing: border-box;\n        -moz-box-sizing: border-box;\n        outline: none;\n        border: 0;\n        margin: 0;\n        width: 100%;\n        padding: 5px;\n        color: #666;\n        font-size: 12px;\n        line-height: 15px;\n        text-align: right;\n        background: #f5f5f5\n    }\n\n    .pika-week {\n        font-size: 11px;\n        color: #999\n    }\n\n    .is-today .pika-button {\n        color: #3af;\n        font-weight: 700\n    }\n\n    .is-selected .pika-button {\n        color: #fff;\n        font-weight: 700;\n        background: #3af;\n        box-shadow: inset 0 1px 3px #178fe5;\n        border-radius: 3px\n    }\n\n    .is-inrange .pika-button {\n        background: #d5e9f7\n    }\n\n    .is-startrange .pika-button {\n        color: #fff;\n        background: #6cb31d;\n        box-shadow: none;\n        border-radius: 3px\n    }\n\n    .is-endrange .pika-button {\n        color: #fff;\n        background: #3af;\n        box-shadow: none;\n        border-radius: 3px\n    }\n\n    .is-disabled .pika-button,\n    .is-outside-current-month .pika-button {\n        pointer-events: none;\n        cursor: default;\n        color: #999;\n        opacity: .3\n    }\n\n    .pika-button:hover {\n        color: #fff;\n        background: #ff8000;\n        box-shadow: none;\n        border-radius: 3px\n    }\n\n    .pika-table abbr {\n        border-bottom: none;\n        cursor: help\n    }\n\n    .htCommentCell {\n        position: relative\n    }\n\n    .htCommentCell:after {\n        content: "";\n        position: absolute;\n        top: 0;\n        right: 0;\n        border-left: 6px solid transparent;\n        border-top: 6px solid #000\n    }\n\n    .htComments {\n        display: none;\n        z-index: 1059;\n        position: absolute\n    }\n\n    .htCommentTextArea {\n        box-shadow: 0 1px 3px rgba(0, 0, 0, .117647), 0 1px 2px rgba(0, 0, 0, .239216);\n        box-sizing: border-box;\n        border: none;\n        border-left: 3px solid #ccc;\n        background-color: #fff;\n        width: 215px;\n        height: 90px;\n        font-size: 12px;\n        padding: 5px;\n        outline: 0 !important;\n        -webkit-appearance: none\n    }\n\n    .htCommentTextArea:focus {\n        box-shadow: 0 1px 3px rgba(0, 0, 0, .117647), 0 1px 2px rgba(0, 0, 0, .239216), inset 0 0 0 1px #5292f7;\n        border-left: 3px solid #5292f7\n    }\n\n    /*!\n * Handsontable ContextMenu\n */\n\n    .htContextMenu:not(.htGhostTable) {\n        display: none;\n        position: absolute;\n        z-index: 1060\n    }\n\n    .htContextMenu .ht_clone_corner,\n    .htContextMenu .ht_clone_debug,\n    .htContextMenu .ht_clone_left,\n    .htContextMenu .ht_clone_top {\n        display: none\n    }\n\n    .htContextMenu table.htCore {\n        border: 1px solid #ccc;\n        border-bottom-width: 2px;\n        border-right-width: 2px\n    }\n\n    .htContextMenu .wtBorder {\n        visibility: hidden\n    }\n\n    .htContextMenu table tbody tr td {\n        background: #fff;\n        border-width: 0;\n        padding: 4px 6px 0;\n        cursor: pointer;\n        overflow: hidden;\n        white-space: nowrap;\n        text-overflow: ellipsis\n    }\n\n    .htContextMenu table tbody tr td:first-child {\n        border: 0\n    }\n\n    .htContextMenu table tbody tr td.htDimmed {\n        font-style: normal;\n        color: #323232\n    }\n\n    .htContextMenu table tbody tr td.current,\n    .htContextMenu table tbody tr td.zeroclipboard-is-hover {\n        background: #f3f3f3\n    }\n\n    .htContextMenu table tbody tr td.htSeparator {\n        border-top: 1px solid #e6e6e6;\n        height: 0;\n        padding: 0;\n        cursor: default\n    }\n\n    .htContextMenu table tbody tr td.htDisabled {\n        color: #999;\n        cursor: default\n    }\n\n    .htContextMenu table tbody tr td.htDisabled:hover {\n        background: #fff;\n        color: #999;\n        cursor: default\n    }\n\n    .htContextMenu table tbody tr.htHidden {\n        display: none\n    }\n\n    .htContextMenu table tbody tr td .htItemWrapper {\n        margin-left: 10px;\n        margin-right: 6px\n    }\n\n    .htContextMenu table tbody tr td div span.selected {\n        margin-top: -2px;\n        position: absolute;\n        left: 4px\n    }\n\n    .htContextMenu .ht_master .wtHolder {\n        overflow: hidden\n    }\n\n    textarea#HandsontableCopyPaste {\n        position: fixed !important;\n        top: 0 !important;\n        right: 100% !important;\n        overflow: hidden;\n        opacity: 0;\n        outline: 0 none !important\n    }\n\n    .htRowHeaders .ht_master.innerBorderLeft~.ht_clone_left td:first-of-type,\n    .htRowHeaders .ht_master.innerBorderLeft~.ht_clone_top_left_corner th:nth-child(2) {\n        border-left: 0 none\n    }\n\n    .handsontable.ht__manualColumnMove.after-selection--columns thead th.ht__highlight {\n        cursor: move;\n        cursor: -webkit-grab;\n        cursor: grab\n    }\n\n    .handsontable.ht__manualColumnMove.on-moving--columns,\n    .handsontable.ht__manualColumnMove.on-moving--columns thead th.ht__highlight {\n        cursor: move;\n        cursor: -webkit-grabbing;\n        cursor: grabbing\n    }\n\n    .handsontable.ht__manualColumnMove.on-moving--columns .manualColumnResizer {\n        display: none\n    }\n\n    .handsontable .ht__manualColumnMove--backlight,\n    .handsontable .ht__manualColumnMove--guideline {\n        position: absolute;\n        height: 100%;\n        display: none\n    }\n\n    .handsontable .ht__manualColumnMove--guideline {\n        background: #757575;\n        width: 2px;\n        top: 0;\n        margin-left: -1px;\n        z-index: 105\n    }\n\n    .handsontable .ht__manualColumnMove--backlight {\n        background: #343434;\n        background: rgba(52, 52, 52, .25);\n        display: none;\n        z-index: 105;\n        pointer-events: none\n    }\n\n    .handsontable.on-moving--columns .ht__manualColumnMove--backlight,\n    .handsontable.on-moving--columns.show-ui .ht__manualColumnMove--guideline {\n        display: block\n    }\n\n    .handsontable .wtHider {\n        position: relative\n    }\n\n    .handsontable.ht__manualRowMove.after-selection--rows tbody th.ht__highlight {\n        cursor: move;\n        cursor: -webkit-grab;\n        cursor: grab\n    }\n\n    .handsontable.ht__manualRowMove.on-moving--rows,\n    .handsontable.ht__manualRowMove.on-moving--rows tbody th.ht__highlight {\n        cursor: move;\n        cursor: -webkit-grabbing;\n        cursor: grabbing\n    }\n\n    .handsontable.ht__manualRowMove.on-moving--rows .manualRowResizer {\n        display: none\n    }\n\n    .handsontable .ht__manualRowMove--backlight,\n    .handsontable .ht__manualRowMove--guideline {\n        position: absolute;\n        width: 100%;\n        display: none\n    }\n\n    .handsontable .ht__manualRowMove--guideline {\n        background: #757575;\n        height: 2px;\n        left: 0;\n        margin-top: -1px;\n        z-index: 105\n    }\n\n    .handsontable .ht__manualRowMove--backlight {\n        background: #343434;\n        background: rgba(52, 52, 52, .25);\n        display: none;\n        z-index: 105;\n        pointer-events: none\n    }\n\n    .handsontable.on-moving--rows .ht__manualRowMove--backlight,\n    .handsontable.on-moving--rows.show-ui .ht__manualRowMove--guideline {\n        display: block\n    }\n\n    .handsontable tbody td[rowspan][class*=area][class*=highlight]:not([class*=fullySelectedMergedCell]):before {\n        opacity: 0\n    }\n\n    .handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-0]:before,\n    .handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-multiple]:before {\n        opacity: .1\n    }\n\n    .handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-1]:before {\n        opacity: .2\n    }\n\n    .handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-2]:before {\n        opacity: .27\n    }\n\n    .handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-3]:before {\n        opacity: .35\n    }\n\n    .handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-4]:before {\n        opacity: .41\n    }\n\n    .handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-5]:before {\n        opacity: .47\n    }\n\n    .handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-6]:before {\n        opacity: .54\n    }\n\n    .handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-7]:before {\n        opacity: .58\n    }\n</style>'},876:function(n,e,t){var o={"./af":617,"./af.js":617,"./ar":618,"./ar-dz":619,"./ar-dz.js":619,"./ar-kw":620,"./ar-kw.js":620,"./ar-ly":621,"./ar-ly.js":621,"./ar-ma":622,"./ar-ma.js":622,"./ar-sa":623,"./ar-sa.js":623,"./ar-tn":624,"./ar-tn.js":624,"./ar.js":618,"./az":625,"./az.js":625,"./be":626,"./be.js":626,"./bg":627,"./bg.js":627,"./bm":628,"./bm.js":628,"./bn":629,"./bn.js":629,"./bo":630,"./bo.js":630,"./br":631,"./br.js":631,"./bs":632,"./bs.js":632,"./ca":633,"./ca.js":633,"./cs":634,"./cs.js":634,"./cv":635,"./cv.js":635,"./cy":636,"./cy.js":636,"./da":637,"./da.js":637,"./de":638,"./de-at":639,"./de-at.js":639,"./de-ch":640,"./de-ch.js":640,"./de.js":638,"./dv":641,"./dv.js":641,"./el":642,"./el.js":642,"./en-au":643,"./en-au.js":643,"./en-ca":644,"./en-ca.js":644,"./en-gb":645,"./en-gb.js":645,"./en-ie":646,"./en-ie.js":646,"./en-nz":647,"./en-nz.js":647,"./eo":648,"./eo.js":648,"./es":649,"./es-do":650,"./es-do.js":650,"./es-us":651,"./es-us.js":651,"./es.js":649,"./et":652,"./et.js":652,"./eu":653,"./eu.js":653,"./fa":654,"./fa.js":654,"./fi":655,"./fi.js":655,"./fo":656,"./fo.js":656,"./fr":657,"./fr-ca":658,"./fr-ca.js":658,"./fr-ch":659,"./fr-ch.js":659,"./fr.js":657,"./fy":660,"./fy.js":660,"./gd":661,"./gd.js":661,"./gl":662,"./gl.js":662,"./gom-latn":663,"./gom-latn.js":663,"./gu":664,"./gu.js":664,"./he":665,"./he.js":665,"./hi":666,"./hi.js":666,"./hr":667,"./hr.js":667,"./hu":668,"./hu.js":668,"./hy-am":669,"./hy-am.js":669,"./id":670,"./id.js":670,"./is":671,"./is.js":671,"./it":672,"./it.js":672,"./ja":673,"./ja.js":673,"./jv":674,"./jv.js":674,"./ka":675,"./ka.js":675,"./kk":676,"./kk.js":676,"./km":677,"./km.js":677,"./kn":678,"./kn.js":678,"./ko":679,"./ko.js":679,"./ky":680,"./ky.js":680,"./lb":681,"./lb.js":681,"./lo":682,"./lo.js":682,"./lt":683,"./lt.js":683,"./lv":684,"./lv.js":684,"./me":685,"./me.js":685,"./mi":686,"./mi.js":686,"./mk":687,"./mk.js":687,"./ml":688,"./ml.js":688,"./mr":689,"./mr.js":689,"./ms":690,"./ms-my":691,"./ms-my.js":691,"./ms.js":690,"./mt":692,"./mt.js":692,"./my":693,"./my.js":693,"./nb":694,"./nb.js":694,"./ne":695,"./ne.js":695,"./nl":696,"./nl-be":697,"./nl-be.js":697,"./nl.js":696,"./nn":698,"./nn.js":698,"./pa-in":699,"./pa-in.js":699,"./pl":700,"./pl.js":700,"./pt":701,"./pt-br":702,"./pt-br.js":702,"./pt.js":701,"./ro":703,"./ro.js":703,"./ru":704,"./ru.js":704,"./sd":705,"./sd.js":705,"./se":706,"./se.js":706,"./si":707,"./si.js":707,"./sk":708,"./sk.js":708,"./sl":709,"./sl.js":709,"./sq":710,"./sq.js":710,"./sr":711,"./sr-cyrl":712,"./sr-cyrl.js":712,"./sr.js":711,"./ss":713,"./ss.js":713,"./sv":714,"./sv.js":714,"./sw":715,"./sw.js":715,"./ta":716,"./ta.js":716,"./te":717,"./te.js":717,"./tet":718,"./tet.js":718,"./th":719,"./th.js":719,"./tl-ph":720,"./tl-ph.js":720,"./tlh":721,"./tlh.js":721,"./tr":722,"./tr.js":722,"./tzl":723,"./tzl.js":723,"./tzm":724,"./tzm-latn":725,"./tzm-latn.js":725,"./tzm.js":724,"./uk":726,"./uk.js":726,"./ur":727,"./ur.js":727,"./uz":728,"./uz-latn":729,"./uz-latn.js":729,"./uz.js":728,"./vi":730,"./vi.js":730,"./x-pseudo":731,"./x-pseudo.js":731,"./yo":732,"./yo.js":732,"./zh-cn":733,"./zh-cn.js":733,"./zh-hk":734,"./zh-hk.js":734,"./zh-tw":735,"./zh-tw.js":735};function a(n){var e=l(n);return t(e)}function l(n){if(!t.o(o,n)){var e=new Error("Cannot find module '"+n+"'");throw e.code="MODULE_NOT_FOUND",e}return o[n]}a.keys=function(){return Object.keys(o)},a.resolve=l,n.exports=a,a.id=876},881:function(n,e){},882:function(n,e){},959:function(n,e,t){"use strict";t.r(e),t.d(e,"AuWidgetDataSheet",function(){return _}),t.d(e,"widget",function(){return _});var o=t(0),a=t(873),l=t.n(a),i=t(874),r=t.n(i),s=t(6),d=t(1),h=t(172);class b{static getAllHeaders(n){const e=[];for(let t of n)for(let n of Object.keys(t))-1===e.indexOf(n)&&e.push(n);return e}static ensureObjectKeysPercents(n){return n.map(n=>{for(let e in n){let t=e;t.startsWith("%")||(t="%"+t),t.endsWith("%")||(t+="%"),t!==e&&(n[t]=n[e],delete n[e])}return n})}static removeDuplicates(n){return n.filter((e,t)=>{const o=JSON.stringify(e);return t===n.findIndex(n=>JSON.stringify(n)===o)})}static appendEmptyKeys(n,e){const t=e.reduce((n,e)=>(n[e]="",n),{});return n.map(n=>Object.assign({},t,n))}}var c=t(616),p=t.n(c);const u="#F78181",g="#FFF";function f(n,e,t,o,a,l,i){p.a.renderers.TextRenderer.apply(this,arguments);const r=n.getDataAtCell(t,o);e.title=i.error||r||"",e.style.backgroundColor=i.error?u:g}class m{constructor(n){Object.assign(this,n)}}var x=t(42),w=t(206),y=t(736);const v=300;var j=t(507),k=t(579),C=t(879);let _=class extends h.b{constructor(){super(),this.selectedRowIndex=0,this.workbookName="out.xlsx",this.columnSchemes=[],this.cellsData=[],this._isRestoring=!1,this.format="full-height",this.tableService=new class{constructor(){this.rowSelectedSubject=new x.a,this.cellChangedSubject=new x.a,this._grid=null,this.headers=[],this.rowsMetadata=[{}],this.isTableCreated=!1,this.selectedRowIndex=0}get rowSelected$(){return this.rowSelectedSubject.asObservable()}get cellChanged$(){return this.cellChangedSubject.asObservable()}get currentHeaders(){return this.headers}get isTableEmpty(){return this.isTableCreated&&0===this._grid.countRows()}drawTable(n,e){if(Object(w.a)(e)||e.length<=0)return;const t=e.map(n=>n.header),o=e.filter(n=>n.readonly).map(n=>n.header);this.setHeaders(t),this.isTableCreated?this.updateTable(o):this.initializeTable(n,o),this._grid.selectRows(0)}loadData(n){for(n=b.appendEmptyKeys(n,this.headers);this.rowsMetadata.length<n.length;)this.rowsMetadata.push({});this._grid.loadData(n),this._grid.selectRows(0)}getData(){return!this._grid||this._grid.isDestroyed?[]:this._grid.getData().map(n=>{const e={};return n.forEach((n,t)=>{e[this.headers[t]]=null===n?"":n}),e})}addRow(){this.rowsMetadata.push({}),this._grid.alter("insert_row")}deleteRow(){const n=this._grid.getSelected();if(!Object(y.a)(n)){const e=n[0][0];this.rowsMetadata.splice(e,1),this._grid.alter("remove_row",e)}}destroyTable(){this.isTableCreated&&(this._grid.destroy(),this.isTableCreated=!1,this.rowsMetadata=[{}])}setDataAtCell(n,e,t,o=null){this._grid.setDataAtCell(n,e,t,o)}setErrorAtCell(n,e,t){const o=this.rowsMetadata[n],a="string"==typeof e?e:this.headers[e];o[a]=Object.assign(Object.assign({},o[a]),{error:t}),this.render()}removeErrorAtCell(n,e){const t=this.rowsMetadata[n],o="string"==typeof e?e:this.headers[e];t[o]=Object.assign(Object.assign({},t[o]),{error:null}),this.render()}getColumnIndex(n){return this.headers.findIndex(e=>e===n)}render(n=!0){this._grid&&this.isTableCreated&&(n?setTimeout(()=>{this._grid.render()},0):this._grid.render())}setHeaders(n,e=!1){if(e)for(let e of n)-1===this.headers.indexOf(e)&&-1===this.headers.indexOf(`%${e}%`)&&-1===this.headers.indexOf(e.replace(/%/g,""))&&this.headers.push(e);else this.headers=n}initializeTable(n,e){Object(w.a)(this.headers)?console.log("Table headers are not presented"):(this._grid=new p.a(n,{data:[[]],columns:this.headers.map(n=>({title:(n||"").replace(/%/g,""),data:n,type:"text"})),cells:(n,t)=>{const o=this.getCellMeta(n,t);return Object.assign(Object.assign({},o),{readOnly:e.indexOf(this.headers[t])>-1,renderer:f})},rowHeaders:!0,colHeaders:!0,viewportRowRenderingOffset:1e3,filters:!1,dropdownMenu:!1,allowRemoveColumn:!0,allowRemoveRow:!0,allowInsertRow:!0,autoColumnSize:!0,autoRowSize:!0,columnSorting:!1,contextMenu:!1,currentRowClassName:"highlight",fillHandle:!1,outsideClickDeselects:!1,preventOverflow:"horizontal",selectionMode:"single",sortByRelevance:!1,stretchH:"all",enterMoves:{row:0,col:1},undo:!1,afterChange:(n,e)=>{if(!n)return;const t=n[0],o=t[2]!==t[3],a=t[0];let l=t[1],i=this.headers.findIndex(n=>n===l);-1===i&&(l=l.replace(/^%|%$/gi,""),i=this.headers.findIndex(n=>n===l)),"edit"===e&&o&&(this.removeErrorAtCell(a,i),this.cellChangedSubject.next(new m({rowIndex:a,colIndex:i,colName:l})))},afterSelection:n=>{Object(w.a)(n)||this.rowSelectedSubject.next(n)},afterRemoveRow:n=>{Object(w.a)(n)||this.rowSelectedSubject.next(n)},beforeKeyDown:n=>{8===n.keyCode||46===n.keyCode?p.a.dom.stopImmediatePropagation(n):37!==n.keyCode&&39!==n.keyCode||"STATE_EDITING"!==this._grid.getActiveEditor().state?n.keyCode:p.a.dom.stopImmediatePropagation(n)},modifyColWidth:n=>{if(n>v)return v}}),this.isTableCreated=!0)}updateTable(n){Object(w.a)(this.headers)?console.log("Table headers are not presented"):this._grid.updateSettings({columns:this.headers.map(n=>({title:(n||"").replace(/%/g,""),data:n,type:"text"})),cells:(e,t)=>{const o=this.getCellMeta(e,t);return Object.assign(Object.assign({},o),{readOnly:n.indexOf(this.headers[t])>-1,renderer:f})}},!1)}getCellMeta(n,e){const t=n>=this.rowsMetadata.length,o=e>=this.headers.length;if(!t&&!o)return this.rowsMetadata[n][this.headers[e]]}},this.xlsxService=new class{constructor(n=!0){this.rABS=n}parseFile(n){if(!n)return Promise.resolve([]);const e=new FileReader;return new Promise((t,o)=>{e.onload=(n=>{let e=n.target.result;this.rABS||(e=new Uint8Array(e));const o=this.parseXSLT(e);t(o)}),e.onerror=(n=>{o(n)}),this.rABS?e.readAsBinaryString(n):e.readAsArrayBuffer(n)})}createWorkbook(n){const e=this.createTable(n);return C.utils.table_to_book(e)}createWorkbookAndDownload(n,e){const t=this.createWorkbook(n);C.writeFile(t,e)}parseXSLT(n){const e=C.read(n,{type:this.rABS?"binary":"array"});return C.utils.sheet_to_json(e.Sheets.Sheet1,{raw:!1})}createTable(n){let e=[];n.forEach(n=>{Object.keys(n).forEach(function(n){-1===e.indexOf(n)&&e.push(n)})});let t=document.createElement("table"),o=document.createElement("tbody"),a=document.createElement("tr");return e.forEach(function(n){let e=document.createElement("th");e.textContent=n.replace(/%/g,""),a.appendChild(e)}),o.appendChild(a),n.forEach(function(n){let e=document.createElement("tr");Object.keys(n).forEach(function(t){let o=document.createElement("td");o.textContent=n[t],e.appendChild(o)}),o.appendChild(e)}),t.appendChild(o),t}},this.rowSelectedSub=this.tableService.rowSelected$.subscribe(async n=>{const e=this.selectedRowIndex.toString();this.rowSelectedHandler(n),this._onRowChange&&e!==n.toString()&&await this._onRowChange()}),this.cellChangedSub=this.tableService.cellChanged$.subscribe(async n=>{this.cellChangedHandler(n),this._onCellTextChange&&await this._onCellTextChange()})}get _(){return this.selectedRow}updateParams(n){null!=n&&(n.fileName&&(this.workbookName=n.fileName),n.data&&(Object(k.a)(n.data,this.columnSchemes)||(this.columnSchemes=n.data,this.drawTable(this.columnSchemes),this.hideButtonsLeft=n.hideButtonsLeft||!1,this.hideButtonsRight=n.hideButtonsRight||!1,this.hideButtonsLeft&&this.$.buttonsLeft.classList.add("hidden"),this.hideButtonsRight&&this.$.buttonsRight.classList.add("hidden"),this.showPreloader(!1)),!s.a.isNotEmptyArray(n.tableData)||!s.a.isNotEmptyArray(n.data)||Object(k.a)(n.tableData,this.defaultTableData)&&Object(k.a)(n.data,this.columnSchemes)||(this.defaultTableData=n.tableData,this.loadData(n.tableData),this.showPreloader(!1))),Object(y.a)(n.updateItem)||this.updateItemData(n.updateItem),Object(y.a)(n.customTexts)||this.updateTexts(n.customTexts),n.allowedFileTypes&&this._updateFileTypes(n.allowedFileTypes),n.onRowChange&&(this._onRowChange=s.a.functionWrapperConstructor(n.onRowChange)),n.onCellTextChange&&(this._onCellTextChange=s.a.functionWrapperConstructor(n.onCellTextChange)),this.emitChange())}_updateFileTypes(n){const e=Array.isArray(n)?n:[n];this.$.openFile.accept=e.join(",")}clearSelection(){throw new Error("Method not implemented.")}addRow(){this.tableService.addRow(),this.notifyPath("tableService.isTableEmpty"),this.emitChange(),this.tableService.render(!0)}deleteRow(){this.cellsData.length>this.selectedRowIndex&&this.cellsData.splice(this.selectedRowIndex,1),this.tableService.deleteRow(),this.notifyPath("tableService.isTableEmpty"),this.emitChange(),this.tableService.render(!0)}setErrors(n){if(!Object(y.a)(n))for(const e of n)Object(w.a)(e.rowIndex)||Object(w.a)(e.itemName)||this.tableService.setErrorAtCell(e.rowIndex,e.itemName,e.message)}getSelectedRowData(){return this.getRowData(this.selectedRowIndex)}getTableData(){return this.tableService.getData().map((n,e)=>this.getRowData(e))}_showTableMessages(n,e){return!n||e}_tableStyle(n){return this.tableService.render(!0),n?"display: block;":"display: none;"}onStepChanged(){this.tableService.render(!0)}getRowData(n){const e=this.tableService.getData()[n],t=this.cellsData[n];return Object.keys(e).map(n=>{const o=Object(j.a)(this.columnSchemes.find(e=>e.name===n)),a=t?t[n]:{};return Object.assign(Object.assign(Object.assign({},o),a),{value:e[n]})})}updateItemData(n){if(!n||!n.name||this.columnSchemes.every(e=>e.name!==n.name))return;let e=this.cellsData[this.selectedRowIndex];if(Object(w.a)(e)&&(e=this.cellsData[this.selectedRowIndex]={}),e[n.name]=n,n.value){const e=this.tableService.currentHeaders.findIndex(e=>e===n.name);"ImagePlaceholder"===this.columnSchemes[e].type&&this.tableService.setDataAtCell(this.selectedRowIndex,e,n.value,"silent")}this.selectedRow=this.tableService.getData()[this.selectedRowIndex],s.a.isNotNullOrUndefined(this.selectedRow)&&this.emitChange({selectedRow:this.selectedRow})}drawTable(n){if(Object(y.a)(n))this.tableService.destroyTable();else{const e=n.map(n=>({header:n.name,defaultValue:n.value,readonly:n.readonly}));this.tableService.drawTable(this.$.table,e)}this.notifyPath("tableService.isTableCreated"),this.notifyPath("tableService.isTableEmpty")}loadData(n){this.tableService.isTableCreated&&(this.tableService.loadData(n),this._isRestoring||this.emitChange())}renderTable(){this.tableService.render(!0)}async exportWidgetData(n){return{tableData:this.tableService.getData(),columnSchemes:this.columnSchemes}}async restoreWidgetFromData(n,e){n&&n.tableData&&(this._isRestoring=!0,this.columnSchemes=n.columnSchemes,this.drawTable(this.columnSchemes),this.loadData(n.tableData),this.tableService.render()),this._isRestoring=!1}updateTexts(n){n.tableIsEmpty&&this.set("texts.emptyRowsText",n.tableIsEmpty),n.tableNotCreatedText&&this.set("texts.tableNotCreatedText",n.tableNotCreatedText)}rowSelectedHandler(n){this.selectedRowIndex=n,this.selectedRow=this.tableService.getData()[n],s.a.isNotNullOrUndefined(this.selectedRow)&&this.emitChange({selectedRowIndex:this.selectedRowIndex,selectedRow:this.selectedRow})}cellChangedHandler(n){this.selectedColumnIndex=n.colIndex;const e=this.columnSchemes.find(e=>e.name===n.colName);if(e&&"ImagePlaceholder"===e.type){const e=this.cellsData[n.rowIndex];e&&(e[n.colName]=null)}this.rowSelectedHandler(n.rowIndex)}openFileDialog(){this.$.openFile.click()}downloadXSLTFile(){const n=this.tableService.getData();this.xlsxService.createWorkbookAndDownload(n,this.workbookName)}changeFile(n){const e=n.target.files[0];if(e.name&&this.params.allowedFileTypes){const n="."+e.name.split(".").slice(-1)[0].toLowerCase();if(-1===s.a.ensureArray(this.params.allowedFileTypes).map(n=>n.toLowerCase()).indexOf(n)){const n=this.localize("widgets.datasheet.messages.wrongFileExtension");return void this.showToast(n,5e3)}}this.xlsxService.parseFile(e).then(n=>{this.loadData(n),this.$.openFile.value=""})}dispose(){this.rowSelectedSub&&!this.rowSelectedSub.closed&&this.rowSelectedSub.unsubscribe(),this.cellChangedSub&&!this.cellChangedSub.closed&&this.cellChangedSub.unsubscribe()}};Object(o.b)([Object(d.c)(),Object(o.d)("design:type",Object),Object(o.d)("design:paramtypes",[])],_.prototype,"_",null),Object(o.b)([Object(d.c)(),Object(o.d)("design:type",Object)],_.prototype,"selectedRow",void 0),Object(o.b)([Object(d.c)(),Object(o.d)("design:type",Number)],_.prototype,"selectedRowIndex",void 0),Object(o.b)([Object(d.c)(),Object(o.d)("design:type",Number)],_.prototype,"selectedColumnIndex",void 0),Object(o.b)([Object(d.c)(),Object(o.d)("design:type",Object)],_.prototype,"params",void 0),Object(o.b)([Object(d.c)(),Object(o.d)("design:type",String)],_.prototype,"text",void 0),Object(o.b)([Object(d.c)(),Object(o.d)("design:type",String)],_.prototype,"workbookName",void 0),Object(o.b)([Object(d.c)(),Object(o.d)("design:type",Array)],_.prototype,"tableData",void 0),_=Object(o.b)([Object(d.a)("au-widget-datasheet",l.a+r.a),Object(o.d)("design:paramtypes",[])],_)}}]);